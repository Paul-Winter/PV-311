<!DOCTYPE html>
<!-- saved from url=(0045)https://habr.com/ru/company/otus/blog/546158/ -->
<html lang="ru"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  
  <meta name="viewport" content="width=device-width,initial-scale=1.0,viewport-fit=cover,maximum-scale=1,user-scalable=0">
  <meta name="referrer" content="unsafe-url">
  <title>Динамический полиморфизм с использованием std::variant и std::visit / Хабр</title>
  <style>
    /* cyrillic-ext */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveSxf6TF0.woff2) format('woff2');
      unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
    }

    /* cyrillic */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveQhf6TF0.woff2) format('woff2');
      unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
    }

    /* latin-ext */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveSBf6TF0.woff2) format('woff2');
      unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
    }

    /* latin */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveRhf6.woff2) format('woff2');
      unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
    }

    /* non-breaking hyphen */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/l/font?kit=KFOlCnqEu92Fr1MmEU9vBh0_IsHAlmrO6g&skey=ee881451c540fdec&v=v29) format('woff2');
      unicode-range: U+02011;
    }
  </style>
  <link rel="preload" href="./Динамический полиморфизм с использованием std__variant и std__visit _ Хабр_files/chunk-vendors.b6238726.css" as="style"><link rel="preload" href="./Динамический полиморфизм с использованием std__variant и std__visit _ Хабр_files/chunk-vendors.aa19bb97.js.загрузка" as="script"><link rel="preload" href="./Динамический полиморфизм с использованием std__variant и std__visit _ Хабр_files/app.218cd7c0.css" as="style"><link rel="preload" href="./Динамический полиморфизм с использованием std__variant и std__visit _ Хабр_files/app.5b494952.js.загрузка" as="script"><link rel="preload" href="./Динамический полиморфизм с использованием std__variant и std__visit _ Хабр_files/7298.c8f1d73c.js.загрузка" as="script">
  <link rel="stylesheet" href="./Динамический полиморфизм с использованием std__variant и std__visit _ Хабр_files/chunk-vendors.b6238726.css"><link rel="stylesheet" href="./Динамический полиморфизм с использованием std__variant и std__visit _ Хабр_files/app.218cd7c0.css">
  <script type="text/javascript" async="" src="./Динамический полиморфизм с использованием std__variant и std__visit _ Хабр_files/analytics.js.загрузка"></script><script async="" src="./Динамический полиморфизм с использованием std__variant и std__visit _ Хабр_files/tag.js.загрузка"></script><script>window.i18nFetch = new Promise((res, rej) => {
          const xhr = new XMLHttpRequest();
          xhr.open('GET', '/js/i18n/ru-compiled.2c4d68417fae4acf58bd47eb3e4e4f63.json');
          xhr.responseType = 'json';
          xhr.onload = function(e) {
            if (this.status === 200) {
              res({ru: xhr.response});
            } else {
              rej(e);
            }
          };
          xhr.send();
        });</script>
  
  <script data-vue-meta="ssr" type="application/ld+json" data-vmid="ldjson-schema">{"@context":"http:\/\/schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/habr.com\/ru\/company\/otus\/blog\/546158\/"},"headline":"Динамический полиморфизм с использованием std::variant и std::visit","datePublished":"2021-03-09T16:27:19+03:00","dateModified":"2021-03-10T11:54:13+03:00","author":{"@type":"Person","name":"OTUS"},"publisher":{"@type":"Organization","name":"Habr","logo":{"@type":"ImageObject","url":"https:\/\/habrastorage.org\/webt\/a_\/lk\/9m\/a_lk9mjkccjox-zccjrpfolmkmq.png"}},"description":"Привет, хабровчане. В рамках курса &quot;C++ Developer. Professional&quot; подготовили для вас перевод материала.Также приглашаем на открытый вебинар по теме &laquo;Области види...","url":"https:\/\/habr.com\/ru\/company\/otus\/blog\/546158\/#post-content-body","about":["c_otus","h_programming","h_cpp","f_develop"],"image":["https:\/\/habr.com\/share\/publication\/546158\/ca42c95ea58ab100d77948cf0cef0845\/","https:\/\/habrastorage.org\/getpro\/habr\/upload_files\/1ca\/31b\/74f\/1ca31b74f514b3b5d7c9e0ab3d4dc6c7.png","https:\/\/habrastorage.org\/getpro\/habr\/upload_files\/87d\/9e8\/e9a\/87d9e8e9ae5a400684d5e056d47cc561.png","https:\/\/habrastorage.org\/getpro\/habr\/upload_files\/4dd\/6c2\/662\/4dd6c2662383b67921a9fe58c3b56765.png","https:\/\/habrastorage.org\/getpro\/habr\/upload_files\/eb2\/f1e\/3aa\/eb2f1e3aaf7900bcf999cea39e133aeb.png"]}</script>
  <script src="./Динамический полиморфизм с использованием std__variant и std__visit _ Хабр_files/gpt.js.загрузка" async=""></script>
  <style>.grecaptcha-badge{visibility: hidden;}</style>
  <meta name="habr-version" content="2.118.0">
  
  <meta data-vue-meta="ssr" property="fb:app_id" content="444736788986613"><meta data-vue-meta="ssr" property="fb:pages" content="472597926099084"><meta data-vue-meta="ssr" name="twitter:card" content="summary_large_image"><meta data-vue-meta="ssr" name="twitter:site" content="@habr_com"><meta data-vue-meta="ssr" property="og:site_name" content="Хабр" data-vmid="og:site_name"><meta data-vue-meta="ssr" property="og:title" content="Динамический полиморфизм с использованием std::variant и std::visit" data-vmid="og:title"><meta data-vue-meta="ssr" name="twitter:title" content="Динамический полиморфизм с использованием std::variant и std::visit" data-vmid="twitter:title"><meta data-vue-meta="ssr" name="aiturec:title" content="Динамический полиморфизм с использованием std::variant и std::visit" data-vmid="aiturec:title"><meta data-vue-meta="ssr" name="description" content="Привет, хабровчане. В рамках курса &amp;quot;C++ Developer. Professional&amp;quot; подготовили для вас перевод материала. Также приглашаем на открытый вебинар по теме «Области видимости и невидимости». Участники..." data-vmid="description"><meta data-vue-meta="ssr" itemprop="description" content="Привет, хабровчане. В рамках курса &amp;quot;C++ Developer. Professional&amp;quot; подготовили для вас перевод материала. Также приглашаем на открытый вебинар по теме «Области видимости и невидимости». Участники..." data-vmid="description:itemprop"><meta data-vue-meta="ssr" property="og:description" content="Привет, хабровчане. В рамках курса &amp;quot;C++ Developer. Professional&amp;quot; подготовили для вас перевод материала. Также приглашаем на открытый вебинар по теме «Области видимости и невидимости». Участники..." data-vmid="og:description"><meta data-vue-meta="ssr" name="twitter:description" content="Привет, хабровчане. В рамках курса &amp;quot;C++ Developer. Professional&amp;quot; подготовили для вас перевод материала. Также приглашаем на открытый вебинар по теме «Области видимости и невидимости». Участники..." data-vmid="twitter:description"><meta data-vue-meta="ssr" property="aiturec:description" content="Привет, хабровчане. В рамках курса &amp;quot;C++ Developer. Professional&amp;quot; подготовили для вас перевод материала. Также приглашаем на открытый вебинар по теме «Области видимости и невидимости». Участники..." data-vmid="aiturec:description"><meta data-vue-meta="ssr" itemprop="image" content="https://habrastorage.org/getpro/habr/upload_files/dae/eb2/791/daeeb27910ce8e2c901230653d3befe4.png" data-vmid="image:itemprop"><meta data-vue-meta="ssr" property="og:image" content="https://habrastorage.org/getpro/habr/upload_files/dae/eb2/791/daeeb27910ce8e2c901230653d3befe4.png" data-vmid="og:image"><meta data-vue-meta="ssr" property="og:image:width" content="1200" data-vmid="og:image:width"><meta data-vue-meta="ssr" property="og:image:height" content="630" data-vmid="og:image:height"><meta data-vue-meta="ssr" property="aiturec:image" content="https://habrastorage.org/getpro/habr/upload_files/dae/eb2/791/daeeb27910ce8e2c901230653d3befe4.png" data-vmid="aiturec:image"><meta data-vue-meta="ssr" name="twitter:image" content="https://habrastorage.org/getpro/habr/upload_files/dae/eb2/791/daeeb27910ce8e2c901230653d3befe4.png" data-vmid="twitter:image"><meta data-vue-meta="ssr" property="vk:image" content="https://habrastorage.org/getpro/habr/upload_files/dae/eb2/791/daeeb27910ce8e2c901230653d3befe4.png?format=vk" data-vmid="vk:image"><meta data-vue-meta="ssr" property="aiturec:item_id" content="546158" data-vmid="aiturec:item_id"><meta data-vue-meta="ssr" property="aiturec:datetime" content="2021-03-09T13:27:19.000Z" data-vmid="aiturec:datetime"><meta data-vue-meta="ssr" content="https://habr.com/ru/company/otus/blog/546158/" property="og:url" data-vmid="og:url"><meta data-vue-meta="ssr" property="og:type" content="article" data-vmid="og:type"><meta data-vue-meta="ssr" property="og:locale" content="ru_RU" data-vmid="og:locale"><meta data-vue-meta="ssr" name="keywords" content="cplusplus, динамический полиморфизм">
  <link data-vue-meta="ssr" href="https://habr.com/ru/rss/post/546158/?fl=ru" type="application/rss+xml" title="" rel="alternate" name="rss"><link data-vue-meta="ssr" href="https://habr.com/ru/company/otus/blog/546158/" rel="canonical" data-vmid="canonical"><link data-vue-meta="ssr" rel="image_src" href="https://habrastorage.org/getpro/habr/upload_files/dae/eb2/791/daeeb27910ce8e2c901230653d3befe4.png" data-vmid="image:href"><link data-vue-meta="ssr" rel="amphtml" href="https://habr.com/ru/amp/post/546158/">
  <meta name="apple-mobile-web-app-status-bar-style" content="#303b44">
  <meta name="msapplication-TileColor" content="#629FBC">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="mobile-web-app-capable" content="yes">
  <link rel="shortcut icon" type="image/png" sizes="16x16" href="https://assets.habr.com/habr-web/img/favicons/favicon-16.png">
  <link rel="shortcut icon" type="image/png" sizes="32x32" href="https://assets.habr.com/habr-web/img/favicons/favicon-32.png">
  <link rel="apple-touch-icon" type="image/png" sizes="76x76" href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-76.png">
  <link rel="apple-touch-icon" type="image/png" sizes="120x120" href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-120.png">
  <link rel="apple-touch-icon" type="image/png" sizes="152x152" href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-152.png">
  <link rel="apple-touch-icon" type="image/png" sizes="180x180" href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-180.png">
  <link rel="apple-touch-icon" type="image/png" sizes="256x256" href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-256.png">
  <link rel="apple-touch-startup-image" media="screen and (device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" href="https://assets.habr.com/habr-web/img/splashes/splash_1136x640.png">
  <link rel="apple-touch-startup-image" media="screen and (device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)" href="https://assets.habr.com/habr-web/img/splashes/splash_2436x1125.png">
  <link rel="apple-touch-startup-image" media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" href="https://assets.habr.com/habr-web/img/splashes/splash_1792x828.png">
  <link rel="apple-touch-startup-image" media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="https://assets.habr.com/habr-web/img/splashes/splash_828x1792.png">
  <link rel="apple-touch-startup-image" media="screen and (device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" href="https://assets.habr.com/habr-web/img/splashes/splash_1334x750.png">
  <link rel="apple-touch-startup-image" media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)" href="https://assets.habr.com/habr-web/img/splashes/splash_1242x2668.png">
  <link rel="apple-touch-startup-image" media="screen and (device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)" href="https://assets.habr.com/habr-web/img/splashes/splash_2208x1242.png">
  <link rel="apple-touch-startup-image" media="screen and (device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)" href="https://assets.habr.com/habr-web/img/splashes/splash_1125x2436.png">
  <link rel="apple-touch-startup-image" media="screen and (device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)" href="https://assets.habr.com/habr-web/img/splashes/splash_1242x2208.png">
  <link rel="apple-touch-startup-image" media="screen and (device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" href="https://assets.habr.com/habr-web/img/splashes/splash_2732x2048.png">
  <link rel="apple-touch-startup-image" media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)" href="https://assets.habr.com/habr-web/img/splashes/splash_2688x1242.png">
  <link rel="apple-touch-startup-image" media="screen and (device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" href="https://assets.habr.com/habr-web/img/splashes/splash_2224x1668.png">
  <link rel="apple-touch-startup-image" media="screen and (device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="https://assets.habr.com/habr-web/img/splashes/splash_750x1334.png">
  <link rel="apple-touch-startup-image" media="screen and (device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="https://assets.habr.com/habr-web/img/splashes/splash_2048x2732.png">
  <link rel="apple-touch-startup-image" media="screen and (device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" href="https://assets.habr.com/habr-web/img/splashes/splash_2388x1668.png">
  <link rel="apple-touch-startup-image" media="screen and (device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="https://assets.habr.com/habr-web/img/splashes/splash_1668x2224.png">
  <link rel="apple-touch-startup-image" media="screen and (device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="https://assets.habr.com/habr-web/img/splashes/splash_640x1136.png">
  <link rel="apple-touch-startup-image" media="screen and (device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="https://assets.habr.com/habr-web/img/splashes/splash_1668x2388.png">
  <link rel="apple-touch-startup-image" media="screen and (device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" href="https://assets.habr.com/habr-web/img/splashes/splash_2048x1536.png">
  <link rel="apple-touch-startup-image" media="screen and (device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="https://assets.habr.com/habr-web/img/splashes/splash_1536x2048.png">
  <link rel="mask-icon" color="#77a2b6" href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-120.svg">
  <link crossorigin="use-credentials" href="https://habr.com/manifest.webmanifest" rel="manifest">
  <script async="" src="./Динамический полиморфизм с использованием std__variant и std__visit _ Хабр_files/pwacompat" crossorigin="anonymous"></script>
  <script>window.yaContextCb = window.yaContextCb || []</script>
  <script src="./Динамический полиморфизм с использованием std__variant и std__visit _ Хабр_files/context.js.загрузка" async=""></script>
<link rel="preconnect" href="https://yastatic.net/"><link rel="preconnect" href="https://avatars.mds.yandex.net/"><link rel="preconnect" href="https://mc.yandex.ru/"><link rel="preconnect" href="https://ads.adfox.ru/"><script async="" crossorigin="anonymous" src="./Динамический полиморфизм с использованием std__variant и std__visit _ Хабр_files/host.js.загрузка"></script><link rel="preload" href="https://yastatic.net/s3/home/fonts/ys/3/text-variable-full.woff2" type="font/woff2" as="font" crossorigin="anonymous"><style id="ysTextCssRule">@font-face {
        font-family: "YS Text Variable";
        src: url("https://yastatic.net/s3/home/fonts/ys/3/text-variable-full.woff2") format("woff2");
        font-weight: 400 700;
        font-display: optional;
    }</style><link rel="stylesheet" type="text/css" href="./Динамический полиморфизм с использованием std__variant и std__visit _ Хабр_files/gallery.0c0f74ca.css"><script data-vue-meta="ssr" onload="window[&#39;e0044d29c024&#39;] = true" src="./Динамический полиморфизм с использованием std__variant и std__visit _ Хабр_files/saved_resource" data-vmid="checklogin"></script><link rel="icon" href="https://habr.com/img/maskable_icon.png" sizes="512x512"><link rel="icon" href="https://habr.com/img/maskable_icon.png" sizes="384x384"><link rel="icon" href="https://habr.com/img/maskable_icon.png" sizes="256x256"><link rel="icon" href="https://habr.com/img/maskable_icon.png" sizes="192x192"><link rel="icon" href="https://habr.com/img/maskable_icon.png" sizes="152x152"><link rel="icon" href="https://habr.com/img/maskable_icon.png" sizes="144x144"><link rel="icon" href="https://habr.com/img/maskable_icon.png" sizes="128x128"><link rel="icon" href="https://habr.com/img/maskable_icon.png" sizes="96x96"><link rel="icon" href="https://habr.com/img/maskable_icon.png" sizes="72x72"><meta name="theme-color" content="#303b44"><meta name="x5-page-mode" content="app"><meta name="browsermode" content="application"></head>
<body>


<div id="app" data-async-called="true"><div class="tm-layout__wrapper"><!----> <div></div> <!----> <header class="tm-header"><div class="tm-page-width"><div class="tm-header__container"><!----> <span class="tm-header__logo-wrap"><a href="https://habr.com/ru/" class="tm-header__logo tm-header__logo_ru"><svg height="16" width="16" class="tm-svg-img tm-header__icon"><title>Хабр</title> <use xlink:href="/img/habr-logo-ru.svg#logo"></use></svg></a> <span class="tm-header__beta-sign" style="display:none;">β</span></span> <div class="tm-dropdown tm-header__projects"><div class="tm-dropdown__head"><button class="tm-header__dropdown-toggle"><svg height="16" width="16" class="tm-svg-img tm-header__icon tm-header__icon_dropdown"><title>Открыть список</title> <use xlink:href="/img/megazord-v28.c350aa68..svg#arrow-down"></use></svg></button></div> <!----></div> <a href="https://habr.com/ru/sandbox/start/" class="tm-header__become-author-btn">
            Как стать автором
          </a> <!----> <a href="https://effect.habr.com/a/KwmWEoZESPrmDhrYGRpR0pV-llSC3eINB87detBxg9yZYTsmXPuIcI4knOHbrBb2GqgZFE5HarooGSrWrg7pyf2P6qalLA69mqQJmjuSNaNEU-frHdFHFsvp_5BB" target="_blank" class="tm-top-link" style="color: rgb(255, 255, 153);">
  Исследуем Духов Машин в новом Сезоне на Хабре
</a> <!----></div></div></header> <div class="tm-layout"><div class="tm-page-progress-bar"></div> <div data-menu-sticky="true" class="tm-base-layout__header tm-base-layout__header_is-sticky"><div class="tm-page-width"><div class="tm-base-layout__header-wrapper"><div class="tm-main-menu"><div class="tm-main-menu__section"><nav class="tm-main-menu__section-content"><!----> <a href="https://habr.com/ru/all/" class="tm-main-menu__item">
        Все потоки
      </a> <a href="https://habr.com/ru/flows/develop/" class="tm-main-menu__item">
          Разработка
        </a><a href="https://habr.com/ru/flows/admin/" class="tm-main-menu__item">
          Администрирование
        </a><a href="https://habr.com/ru/flows/design/" class="tm-main-menu__item">
          Дизайн
        </a><a href="https://habr.com/ru/flows/management/" class="tm-main-menu__item">
          Менеджмент
        </a><a href="https://habr.com/ru/flows/marketing/" class="tm-main-menu__item">
          Маркетинг
        </a><a href="https://habr.com/ru/flows/popsci/" class="tm-main-menu__item">
          Научпоп
        </a></nav></div></div> <div class="tm-header-user-menu tm-base-layout__user-menu"><a href="https://habr.com/ru/search/" class="tm-header-user-menu__item tm-header-user-menu__search"><svg height="24" width="24" class="tm-svg-img tm-header-user-menu__icon tm-header-user-menu__icon_search tm-header-user-menu__icon_dark"><title>Поиск</title> <use xlink:href="/img/megazord-v28.c350aa68..svg#search"></use></svg></a> <!----> <!----> <!----> <div class="tm-header-user-menu__item tm-header-user-menu__user_desktop"><div class="tm-dropdown"><div class="tm-dropdown__head"><svg height="24" width="24" data-test-id="menu-toggle-guest" class="tm-svg-img tm-header-user-menu__icon tm-header-user-menu__icon_dark"><title>Профиль</title> <use xlink:href="/img/megazord-v28.c350aa68..svg#header-user"></use></svg> <!----></div> <!----></div> <!----></div> <!----></div></div></div></div> <button class="tm-scroll-top"><span class="tm-svg-icon__wrapper tm-scroll-top__arrow"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Наверх</title> <use xlink:href="/img/megazord-v28.c350aa68..svg#small-arrow"></use></svg></span></button> <div class="tm-page-width"></div> <main class="tm-layout__container"><div hl="ru" companyname="otus" data-async-called="true" class="tm-page"><div class="tm-page-width"><div class="tm-page__header"><!----></div> <div class="tm-page__wrapper"><div class="tm-page__main tm-page__main_has-sidebar"><div class="pull-down"><!----> <div class="pull-down__header" style="height:0px;"><div class="pull-down__content" style="bottom:10px;"><svg height="24" width="24" class="tm-svg-img pull-down__arrow"><title>Обновить</title> <use xlink:href="/img/megazord-v28.c350aa68..svg#pull-arrow"></use></svg></div></div> <div class="tm-article-presenter"><div class="tm-company-profile-card tm-company-article__profile-card"><div class="tm-company-card tm-company-profile-card__info"><div class="tm-company-card__header"><a href="https://habr.com/ru/company/otus/profile/" class="tm-company-card__avatar"><div class="tm-entity-image"><img alt="" height="48" src="./Динамический полиморфизм с использованием std__variant и std__visit _ Хабр_files/2d50edb57cf45fa07cc4f39f53b78395.png" width="48" class="tm-entity-image__pic"></div></a> <!----> <div class="tm-counter-container tm-company-card__rating"><div class="tm-counter-container__header"> <div class="tm-votes-lever tm-votes-lever tm-votes-lever_appearance-rating"><!----> <div class="tm-votes-lever__score tm-votes-lever__score tm-votes-lever__score_appearance-rating"><span class="tm-votes-lever__score-counter tm-votes-lever__score-counter tm-votes-lever__score-counter_rating">
        781.87
      </span></div> <!----></div></div> <div class="tm-counter-container__footer"><span class="tm-rating__text tm-rating__text">
      Рейтинг
    </span></div></div> <!----></div> <div class="tm-company-card__info"><a href="https://habr.com/ru/company/otus/profile/" class="tm-company-card__name">OTUS</a> <div class="tm-company-card__description">Цифровые навыки от ведущих экспертов</div></div></div> <!----></div> <div class="tm-article-presenter__body"><div class="tm-misprint-area"><div class="tm-misprint-area__wrapper"><article class="tm-article-presenter__content tm-article-presenter__content_narrow"><div class="tm-article-presenter__header"> <div class="tm-article-snippet tm-article-presenter__snippet tm-article-snippet"><div class="tm-article-snippet__meta-container"><div class="tm-article-snippet__meta"><span class="tm-user-info tm-article-snippet__author"><a href="https://habr.com/ru/users/MaxRokatansky/" title="MaxRokatansky" class="tm-user-info__userpic"><div class="tm-entity-image"><img alt="" height="24" src="./Динамический полиморфизм с использованием std__variant и std__visit _ Хабр_files/b9fbaf5f96ae52973706a0716bd9216e.jpg" width="24" class="tm-entity-image__pic"></div></a> <span class="tm-user-info__user"><a href="https://habr.com/ru/users/MaxRokatansky/" class="tm-user-info__username">
      MaxRokatansky
      <!----></a> <span class="tm-article-datetime-published"><time datetime="2021-03-09T13:27:19.000Z" title="2021-03-09, 16:27">9  мар  2021 в 16:27</time></span></span></span></div> <!----></div> <h1 lang="ru" class="tm-title tm-title_h1"><span>Динамический полиморфизм с использованием std::variant и std::visit</span></h1> <div class="tm-article-snippet__stats"><!----> <div class="tm-article-reading-time"><span class="tm-svg-icon__wrapper tm-article-reading-time__icon"><svg height="24" width="24" class="tm-svg-img tm-svg-icon"><title>Время на прочтение</title> <use xlink:href="/img/megazord-v28.c350aa68..svg#clock"></use></svg></span> <span class="tm-article-reading-time__label">
    13 мин
  </span></div> <span class="tm-icon-counter tm-data-icons__item"><svg height="24" width="24" class="tm-svg-img tm-icon-counter__icon"><title>Количество просмотров</title> <use xlink:href="/img/megazord-v28.c350aa68..svg#counter-views"></use></svg> <span class="tm-icon-counter__value">22K</span></span></div> <div class="tm-article-snippet__hubs-container"><div class="tm-article-snippet__hubs"><span class="tm-article-snippet__hubs-item"><a href="https://habr.com/ru/company/otus/blog/" class="tm-article-snippet__hubs-item-link router-link-active"><span>Блог компании OTUS</span> <!----></a></span><span class="tm-article-snippet__hubs-item"><a href="https://habr.com/ru/hub/programming/" class="tm-article-snippet__hubs-item-link"><span>Программирование</span> <span title="Профильный хаб" class="tm-article-snippet__profiled-hub">*</span></a></span><span class="tm-article-snippet__hubs-item"><a href="https://habr.com/ru/hub/cpp/" class="tm-article-snippet__hubs-item-link"><span>C++</span> <span title="Профильный хаб" class="tm-article-snippet__profiled-hub">*</span></a></span></div></div> <div class="tm-article-snippet__labels-container"><div class="tm-article-snippet__labels"><!----> <div class="tm-article-snippet__label tm-article-snippet__label tm-article-snippet__label_variant-translation"><span>
          Перевод
        </span></div></div></div> <!----> <!----></div></div> <div class="tm-article-presenter__origin"><a href="https://www.bfilipek.com/2020/04/variant-virtual-polymorphism.html" target="_blank" class="tm-article-presenter__origin-link">
                Автор оригинала:
                <span>
                  Bartlomiej Filipek
                </span></a></div> <div data-gallery-root="" lang="ru" class="tm-article-body"><div></div> <div id="post-content-body"><div><div class="article-formatted-body article-formatted-body article-formatted-body_version-2"><div xmlns="http://www.w3.org/1999/xhtml"><blockquote><p><em>Привет, хабровчане. В рамках курса </em><a href="https://otus.pw/vYZR/"><em>"C++ Developer. Professional"</em></a><em> подготовили для вас перевод материала.<br><br>Также приглашаем на открытый вебинар по теме </em><a href="https://otus.pw/6if1/"><em>«Области видимости и невидимости».</em></a><em> Участники вместе с экспертом на полуторачасовом занятии реализуют класс общего назначения и попробуют запустить несколько unit-тестов с использованием googletest.</em></p></blockquote><figure class="full-width "><img src="./Динамический полиморфизм с использованием std__variant и std__visit _ Хабр_files/1ca31b74f514b3b5d7c9e0ab3d4dc6c7.png" width="780" height="439" data-src="https://habrastorage.org/getpro/habr/upload_files/1ca/31b/74f/1ca31b74f514b3b5d7c9e0ab3d4dc6c7.png"><figcaption></figcaption></figure><hr><figure class="full-width "><img src="./Динамический полиморфизм с использованием std__variant и std__visit _ Хабр_files/87d9e8e9ae5a400684d5e056d47cc561.png" width="800" height="256" data-src="https://habrastorage.org/getpro/habr/upload_files/87d/9e8/e9a/87d9e8e9ae5a400684d5e056d47cc561.png"><figcaption></figcaption></figure><p>Динамический полиморфизм (или полиморфизм времени выполнения) обычно связан с v-таблицами и виртуальными функциями. Однако в этой статье я покажу вам современную технику C++, которая использует <code>std::variant</code> и <code>std::visit</code>. Этот метод C++17 может предложить вам не только лучшую производительность и семантику значений, но и интересные паттерны проектирования.</p><p><strong>Последнее обновление:</strong> 2 ноября 2020 г. (передача аргументов, бенчмарк времени сборки, исправления).</p><h3>Виртуальные функции</h3><p>Могу поспорить, что во многих случаях, когда вы слышите о динамическом полиморфизме, вам на ум в первую очередь приходят виртуальные функции.</p><p>Вы объявляете виртуальную функцию в базовом классе, а затем переопределяете ее в производных классах. Когда вы вызываете такую ​​функцию для ссылки или указателя на базовый класс, компилятор вызовет правильную перегрузку. В большинстве случаев компиляторы реализуют эту технику с&nbsp;помощью виртуальных таблиц (v-таблиц). Каждый класс, имеющий виртуальный метод, содержит дополнительную таблицу, указывающую на адреса функций-членов. Перед каждым вызовом виртуального метода компилятор должен просмотреть v-таблицу и разрешить адрес производной функции.</p><p>Канонический пример:</p><pre><code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Base</span> {</span>
<span class="hljs-keyword">public</span>:
    <span class="hljs-keyword">virtual</span> ~<span class="hljs-built_in">Base</span>() = <span class="hljs-keyword">default</span>;

    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">PrintName</span><span class="hljs-params">()</span> <span class="hljs-keyword">const</span> </span>{ 
        std::cout &lt;&lt; <span class="hljs-string">"calling Bases!\n"</span>
    }
};

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Derived</span> :</span> <span class="hljs-keyword">public</span> Base {
<span class="hljs-keyword">public</span>:
    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">PrintName</span><span class="hljs-params">()</span> <span class="hljs-keyword">const</span> <span class="hljs-keyword">override</span> </span>{ 
        std::cout &lt;&lt; <span class="hljs-string">"calling Derived!\n"</span>
    }
};

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ExtraDerived</span> :</span> <span class="hljs-keyword">public</span> Base {
<span class="hljs-keyword">public</span>:
    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">PrintName</span><span class="hljs-params">()</span> <span class="hljs-keyword">const</span> <span class="hljs-keyword">override</span> </span>{ 
        std::cout &lt;&lt; <span class="hljs-string">"calling ExtraDerived!\n"</span>
    }
};

std::unique_ptr&lt;Base&gt; pObject = std::make_unique&lt;Derived&gt;();
pObject-&gt;<span class="hljs-built_in">PrintName</span>();</code></pre><p>В чем преимущества этой техники? Назовем несколько:</p><ul><li><p>Синтаксис встроен в язык, поэтому это очень естественный и удобный способ написания кода.</p></li></ul><ul><li><p>Если вы хотите добавить новый тип, вы просто пишете новый класс, не нужно менять базовый класс.</p></li></ul><ul><li><p>Объектно-ориентированность — позволяет создавать глубокие иерархии.</p></li></ul><ul><li><p>Можно хранить разнородные типы в одном контейнере, просто сохраняя указатели на базовый класс.</p></li></ul><ul><li><p>Передавать параметры в функции очень просто.</p></li></ul><p>Хочу обратить ваше внимание на «расширяемость». Например, благодаря этому функционалу вы можете реализовать систему плагинов. Вы раскрываете интерфейс через некоторый базовый класс, но вы не знаете окончательное количество плагинов. Они даже могут загружаться динамически. Виртуальная диспетчеризация является важной частью этой системы.</p><p>А в чем недостатки?</p><ul><li><p>Виртуальный метод должен быть разрешен до вызова, поэтому возникают дополнительные накладные расходы на производительность (компиляторы изо всех сил стараются максимально девиртуализировать вызовы, но в большинстве случаев это невозможно).</p></li></ul><ul><li><p>Поскольку вам нужен указатель для вызова метода, обычно это также означает динамическую аллокацию, которая может еще больше повысить накладные расходы на производительность.</p></li></ul><ul><li><p>Если вы хотите добавить новый виртуальный метод, вам нужно пройти через базовый и производные классы и добавить туда эту новую функцию.</p></li></ul><p>Однако в C++17 (и немного раньше, благодаря библиотекам boost) у нас также есть другой способ реализовать динамический полиморфизм! Давайте посмотрим на него.</p><h3>Динамический полиморфизм с помощью std::variant и std::visit</h3><p>С <code>std::variant</code>, доступным с C++17, вы теперь можете использовать безопасные объединения типов и хранить множество разных типов в одном объекте. Вместо указателя на базовый класс хранить все «производные» классы может <code>std::variant</code>.</p><p>Давайте перепишем наш первый пример с базовым классом <code>Base</code>, используя эту новую технику:&nbsp;</p><p>Во-первых, классы:</p><pre><code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Derived</span> {</span>
<span class="hljs-keyword">public</span>:
    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">PrintName</span><span class="hljs-params">()</span> <span class="hljs-keyword">const</span> </span>{ 
        std::cout &lt;&lt; <span class="hljs-string">"calling Derived!\n"</span>
    }
};

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ExtraDerived</span> {</span>
<span class="hljs-keyword">public</span>:
    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">PrintName</span><span class="hljs-params">()</span> <span class="hljs-keyword">const</span> </span>{ 
        std::cout &lt;&lt; <span class="hljs-string">"calling ExtraDerived!\n"</span>
    }
};</code></pre><p>Как видите, базового класса больше нет! Теперь у нас может быть куча несвязанных типов.</p><p>А теперь основная часть:</p><pre><code class="cpp hljs">std::variant&lt;Derived, ExtraDerived&gt; var;</code></pre><p><code>var</code> определяет объект, который может быть Derived или ExtraDerived. По умолчанию он инициализируется значением по умолчанию первой альтернативы. Вы можете узнать больше о variant в моей отдельной большой статье: <a href="https://www.bfilipek.com/2018/06/variant.html">Все, что вам нужно знать о std::variant из C ++ 17</a>.</p><h4>Вызов функций</h4><p>Как нам вызвать <code>PrintName()</code> в зависимости от типа, который в данный момент активен внутри var?</p><p>Нам нужны две вещи: вызываемый объект и <code>std::visit</code>.</p><pre><code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">CallPrintName</span> {</span>
    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">operator</span><span class="hljs-params">()</span><span class="hljs-params">(<span class="hljs-keyword">const</span> Derived&amp; d)</span> </span>{ d.<span class="hljs-built_in">PrintName</span>(); }    
    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">operator</span><span class="hljs-params">()</span><span class="hljs-params">(<span class="hljs-keyword">const</span> ExtraDerived&amp; ed)</span> </span>{ ed.<span class="hljs-built_in">PrintName</span>(); }    
};

std::<span class="hljs-built_in">visit</span>(CallPrintName{}, var);</code></pre><p>В приведенном выше примере я создал структуру, которая реализует две перегрузки для оператора вызова. Затем <code>std::visit</code> принимает вариантный объект и вызывает правильную перегрузку.</p><p>Если наши вариантные подтипы имеют общий интерфейс, мы также можем выразить посетителя (visitor) с помощью обобщенной лямбды:</p><pre><code class="cpp hljs"><span class="hljs-keyword">auto</span> caller = [](<span class="hljs-keyword">const</span> <span class="hljs-keyword">auto</span>&amp; obj) { obj.<span class="hljs-built_in">PrintName</span>(); }
std::<span class="hljs-built_in">visit</span>(caller, var);</code></pre><h4>Передача аргументов</h4><p>Наши функции «печати» не принимают никаких аргументов… но что, если они вам понадобятся?</p><p>С обычными функциями это не сложно, просто напишите:</p><pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">PrintName</span><span class="hljs-params">(std::string_view intro)</span> <span class="hljs-keyword">const</span> </span>{ 
    std::cout &lt;&lt; intro &lt;&lt; <span class="hljs-string">" calling Derived!\n;
}</span></code></pre><p>Но с нашим объектом-функцией это непросто. Основная проблема заключается в том, что <code>std::visit()</code> не имеет возможности передавать аргументы в вызываемый объект. Он принимает только объект-функцию и список объектов <code>std::variant</code> (или всего один в нашем случае).</p><p>Один из способов разрешить это неудобство — создать дополнительные переменные-члены для хранения параметров и вручную передать их в операторы вызова.</p><pre><code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">CallPrintName</span> {</span>
    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">operator</span><span class="hljs-params">()</span><span class="hljs-params">(<span class="hljs-keyword">const</span> Derived&amp; d)</span> </span>{ d.<span class="hljs-built_in">PrintName</span>(intro); }    
    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">operator</span><span class="hljs-params">()</span><span class="hljs-params">(<span class="hljs-keyword">const</span> ExtraDerived&amp; ed)</span> </span>{ ed.<span class="hljs-built_in">PrintName</span>(intro); } 

    std::string_view intro;
};

std::<span class="hljs-built_in">visit</span>(CallPrintName{<span class="hljs-string">"intro text"</span>}, var);</code></pre><p>Если ваш посетитель (visitor) является лямбда-выражением, вы можете захватить аргумент и затем передать его функциям-членам:</p><pre><code class="cpp hljs"><span class="hljs-keyword">auto</span> caller = [&amp;intro](<span class="hljs-keyword">const</span> <span class="hljs-keyword">auto</span>&amp; obj) { obj.<span class="hljs-built_in">PrintName</span>(intro); }
std::<span class="hljs-built_in">visit</span>(caller, var);</code></pre><p>Давайте теперь рассмотрим плюсы и минусы такого подхода. Видите ли вы отличия от виртуальной диспетчеризации?</p><h4>Преимущества полиморфизма с std::variant&nbsp;</h4><ul><li><p>Семантика значений, отсутствие динамической аллокации</p></li></ul><ul><li><p>Легко добавить новый «метод», вам нужно реализовать новую вызываемую структуру. Нет необходимости изменять реализацию классов</p></li></ul><ul><li><p>Нет необходимости в базовом классе, классы могут быть не связанными</p></li></ul><ul><li><p>Утиная типизация (Duck typing): хотя виртуальные функции должны иметь одинаковые сигнатуры, это не тот случай, когда вы вызываете функции из посетителя (visitor). У них может быть разное количество аргументов, типов возвращаемых значений и т. д. Это дает нам дополнительную гибкость.</p></li></ul><h4>Недостатки полиморфизма с std::variant полиморфизма</h4><ul><li><p>Вам необходимо знать все типы заранее, во время компиляции. Это исключает возможность создания таких конструкций, как система плагинов. Также сложно добавлять новые типы, так как это подразумевает изменение типа variant и всех посетителей.</p></li></ul><ul><li><p>Это может привести к избыточному потреблению памяти, так как <code>std::variant</code> имеет размер равный максимальному размеру поддерживаемых типов. Итак, если один тип занимает 10 байт, а другой — 100 байт, тогда каждый вариант будет составлять не менее 100 байт. Таким образом, вы потенциально потеряете 90 байт.</p></li></ul><ul><li><p>Утиная типизация: это как преимущество, так и недостаток, в зависимости от правил, необходимых для обеспечения соблюдения функций и типов.</p></li></ul><ul><li><p>Для каждой операции требуется писать отдельного посетителя. Иногда их организация может быть проблемой.</p></li></ul><ul><li><p>Передача параметров не так проста, как с обычными функциями, поскольку <code>std::visit</code> не имеет для этого интерфейса.</p></li></ul><h3>Пример</h3><p>Ранее я показал вам базовый искусственный пример, но давайте попробуем что-нибудь более полезное и реалистичное.</p><p>Представьте себе набор классов, которые представляют метку (Label) в пользовательском интерфейсе. У нас может быть <code>SimpleLabel</code> с каким-нибудь текстом, затем <code>DateLabel</code>, который умеет красиво отображать значение даты, а затем <code>IconLabel</code>, который отображает значок рядом с текстом.</p><p>Для каждой метки нам нужен метод, который сгенерирует HTML-синтаксис, чтобы ее можно было отобразить позже:</p><pre><code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ILabel</span> {</span>
<span class="hljs-keyword">public</span>:
    <span class="hljs-keyword">virtual</span> ~<span class="hljs-built_in">ILabel</span>() = <span class="hljs-keyword">default</span>;

    [[nodiscard]] <span class="hljs-function"><span class="hljs-keyword">virtual</span> std::string <span class="hljs-title">BuildHTML</span><span class="hljs-params">()</span> <span class="hljs-keyword">const</span> </span>= <span class="hljs-number">0</span>;
};

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SimpleLabel</span> :</span> <span class="hljs-keyword">public</span> ILabel {
<span class="hljs-keyword">public</span>:
    <span class="hljs-built_in">SimpleLabel</span>(std::string str) : _str(std::<span class="hljs-built_in">move</span>(str)) { }

    [[nodiscard]] <span class="hljs-function">std::string <span class="hljs-title">BuildHTML</span><span class="hljs-params">()</span> <span class="hljs-keyword">const</span> <span class="hljs-keyword">override</span> </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-string">"&lt;p&gt;"</span> + _str + <span class="hljs-string">"&lt;/p&gt;"</span>;
    }

<span class="hljs-keyword">private</span>:
    std::string _str;    
};

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">DateLabel</span> :</span> <span class="hljs-keyword">public</span> ILabel {
<span class="hljs-keyword">public</span>:
    <span class="hljs-built_in">DateLabel</span>(std::string dateStr) : _str(std::<span class="hljs-built_in">move</span>(dateStr)) { }

    [[nodiscard]] <span class="hljs-function">std::string <span class="hljs-title">BuildHTML</span><span class="hljs-params">()</span> <span class="hljs-keyword">const</span> <span class="hljs-keyword">override</span> </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-string">"&lt;p class=\"date\"&gt;Date: "</span> + _str + <span class="hljs-string">"&lt;/p&gt;"</span>;
    }

<span class="hljs-keyword">private</span>:
    std::string _str;    
};

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">IconLabel</span> :</span> <span class="hljs-keyword">public</span> ILabel {
<span class="hljs-keyword">public</span>:
    <span class="hljs-built_in">IconLabel</span>(std::string str, std::string iconSrc) : 
         _str(std::<span class="hljs-built_in">move</span>(str)), _iconSrc(std::<span class="hljs-built_in">move</span>(iconSrc)) { }

    [[nodiscard]] <span class="hljs-function">std::string <span class="hljs-title">BuildHTML</span><span class="hljs-params">()</span> <span class="hljs-keyword">const</span> <span class="hljs-keyword">override</span> </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-string">"&lt;p&gt;&lt;img src=\""</span> + _iconSrc + <span class="hljs-string">"\"/&gt;"</span> + _str + <span class="hljs-string">"&lt;/p&gt;"</span>;
    }

<span class="hljs-keyword">private</span>:
    std::string _str;    
    std::string _iconSrc;
};</code></pre><p>В приведенном выше примере показан интерфейс <code>ILabel</code>, а затем несколько производных классов, которые реализуют функцию-член BuildHTML.</p><p>А здесь мы видим вариант использования, где у нас есть вектор с указателями на ILabel и мы вызываем виртуальную функцию для генерации окончательного HTML-вывода:</p><pre><code class="cpp hljs">std::vector&lt;std::unique_ptr&lt;ILabel&gt;&gt; vecLabels;
vecLabels.<span class="hljs-built_in">emplace_back</span>(std::make_unique&lt;SimpleLabel&gt;(<span class="hljs-string">"Hello World"</span>));
vecLabels.<span class="hljs-built_in">emplace_back</span>(std::make_unique&lt;DateLabel&gt;(<span class="hljs-string">"10th August 2020"</span>));
vecLabels.<span class="hljs-built_in">emplace_back</span>(std::make_unique&lt;IconLabel&gt;(<span class="hljs-string">"Error"</span>, <span class="hljs-string">"error.png"</span>));

std::string finalHTML;
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">auto</span> &amp;label : vecLabels)
    finalHTML += label-&gt;<span class="hljs-built_in">BuildHTML</span>() + <span class="hljs-string">'\n'</span>;

std::cout &lt;&lt; finalHTML;</code></pre><p>Ничего сверхъестественного, вызовы BuildHTML являются виртуальными, поэтому в конце мы получим ожидаемый результат:</p><pre><code class="cpp hljs">&lt;p&gt;Hello World&lt;/p&gt;
&lt;p <span class="hljs-class"><span class="hljs-keyword">class</span>=</span><span class="hljs-string">"date"</span>&gt;Date: <span class="hljs-number">10</span>th August <span class="hljs-number">2020</span>&lt;/p&gt;
&lt;p&gt;&lt;img src=<span class="hljs-string">"error.png"</span>/&gt;Error&lt;/p&gt;</code></pre><p>А вот вариант с <code>std::variant</code>:</p><pre><code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">VSimpleLabel</span> {</span>
    std::string _str;    
};

<span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">VDateLabel</span> {</span>
    std::string _str;    
};

<span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">VIconLabel</span> {</span>
    std::string _str;    
    std::string _iconSrc;
};

<span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">HTMLLabelBuilder</span> {</span>
    [[nodiscard]] <span class="hljs-function">std::string <span class="hljs-title">operator</span><span class="hljs-params">()</span><span class="hljs-params">(<span class="hljs-keyword">const</span> VSimpleLabel&amp; label)</span> </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-string">"&lt;p&gt;"</span> + label._str + <span class="hljs-string">"&lt;/p&gt;"</span>;
    }
    [[nodiscard]] <span class="hljs-function">std::string <span class="hljs-title">operator</span><span class="hljs-params">()</span><span class="hljs-params">(<span class="hljs-keyword">const</span> VDateLabel&amp; label)</span> </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-string">"&lt;p class=\"date\"&gt;Date: "</span> + label._str + <span class="hljs-string">"&lt;/p&gt;"</span>;
    }
    [[nodiscard]] <span class="hljs-function">std::string <span class="hljs-title">operator</span><span class="hljs-params">()</span><span class="hljs-params">(<span class="hljs-keyword">const</span> VIconLabel&amp; label)</span> </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-string">"&lt;p&gt;&lt;img src=\""</span> + label._iconSrc + <span class="hljs-string">"\"/&gt;"</span> + label._str + <span class="hljs-string">"&lt;/p&gt;"</span>;
    }
};</code></pre><p>В предыдущем фрагменте кода я упростил интерфейс для классов <code>Label</code>. Теперь они хранят только данные, а HTML-операции перемещены в <code>HTMLLabelBuilder</code>.</p><p>И вариант использования:</p><pre><code class="cpp hljs"><span class="hljs-keyword">using</span> LabelVariant = std::variant&lt;VSimpleLabel, VDateLabel, VIconLabel&gt;;
std::vector&lt;LabelVariant&gt; vecLabels;
vecLabels.<span class="hljs-built_in">emplace_back</span>(VSimpleLabel { <span class="hljs-string">"Hello World"</span>});
vecLabels.<span class="hljs-built_in">emplace_back</span>(VDateLabel { <span class="hljs-string">"10th August 2020"</span>});
vecLabels.<span class="hljs-built_in">emplace_back</span>(VIconLabel { <span class="hljs-string">"Error"</span>, <span class="hljs-string">"error.png"</span>});

std::string finalHTML;
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">auto</span> &amp;label : vecLabels)
    finalHTML += std::<span class="hljs-built_in">visit</span>(HTMLLabelBuilder{}, label) + <span class="hljs-string">'\n'</span>;

std::cout &lt;&lt; finalHTML;</code></pre><p>Пример доступен на сайте <a href="http://coliru.stacked-crooked.com/a/e20e60c0e96771e6">Coliru.</a></p><h4>Альтернативы</h4><p><code>HTMLLabelBuilder</code> — это только один вариант, который мы можем использовать. В качестве альтернативы мы также можем написать обобщенную лямбду, которая вызывает функцию-член из производных классов:</p><pre><code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">VSimpleLabel</span> {</span>
    [[nodiscard]] <span class="hljs-function">std::string <span class="hljs-title">BuildHTML</span><span class="hljs-params">()</span> <span class="hljs-keyword">const</span> </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-string">"&lt;p class=\"date\"&gt;Date: "</span> + _str + <span class="hljs-string">"&lt;/p&gt;"</span>;
    }

    std::string _str;    
};

<span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">VDateLabel</span> {</span>
    [[nodiscard]] <span class="hljs-function">std::string <span class="hljs-title">BuildHTML</span><span class="hljs-params">()</span> <span class="hljs-keyword">const</span> </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-string">"&lt;p class=\"date\"&gt;Date: "</span> + _str + <span class="hljs-string">"&lt;/p&gt;"</span>;
    }

    std::string _str;    
};

<span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">VIconLabel</span> {</span>
    [[nodiscard]] <span class="hljs-function">std::string <span class="hljs-title">BuildHTML</span><span class="hljs-params">()</span> <span class="hljs-keyword">const</span> </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-string">"&lt;p&gt;&lt;img src=\""</span> + _iconSrc + <span class="hljs-string">"\"/&gt;"</span> + _str + <span class="hljs-string">"&lt;/p&gt;"</span>;
    }

    std::string _str;    
    std::string _iconSrc;
};

<span class="hljs-keyword">auto</span> callBuildHTML = [](<span class="hljs-keyword">auto</span>&amp; label) { <span class="hljs-keyword">return</span> label.<span class="hljs-built_in">BuildHTML</span>(); };
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">auto</span> &amp;label : vecLabels)
    finalHTML += std::<span class="hljs-built_in">visit</span>(callBuildHTML, label) + <span class="hljs-string">'\n'</span></code></pre><p>На этот раз мы используем обобщенную лямбду, преимущество которой заключается в том, что вызов находится в одном месте.</p><h4>Добавление концептов (Concepts) в обобщенные лямбды</h4><p>В разделе посвященному недостаткам <code>std::variant/std::visit</code> я упомянул, что утиная типизация иногда может быть проблемой. Если хотите, вы можете применить интерфейс к типам и функциям. Например, с помощью C++20 мы можем написать концепт, который позволяет нам вызывать обобщенную лямбду только для типов, которые предоставляют требуемый интерфейс.</p><p>(Спасибо Mariusz J за эту идею)</p><pre><code class="cpp hljs"><span class="hljs-keyword">template</span> &lt;<span class="hljs-keyword">typename</span> T&gt;
<span class="hljs-keyword">concept</span> ILabel = <span class="hljs-built_in"><span class="hljs-keyword">requires</span></span>(<span class="hljs-keyword">const</span> T v)
{
    {v.<span class="hljs-built_in">buildHtml</span>()} -&gt; std::convertible_to&lt;std::string&gt;;
};</code></pre><p>Этому концепту удовлетворяют все типы, у которых есть константная функция-член <code>buildHtml()</code>, которая возвращает типы, конвертируемые в <code>std::string</code>.</p><p>Теперь мы можем использовать его для принудительного применения обобщенной лямбды (благодаря краткому синтаксису <code>constrained auto</code>):</p><pre><code class="cpp hljs"><span class="hljs-keyword">auto</span> callBuildHTML = [](ILabel <span class="hljs-keyword">auto</span>&amp; label) -&gt; std::string { <span class="hljs-keyword">return</span> label.<span class="hljs-built_in">buildHtml</span>(); };
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">auto</span> &amp;label : vecLabels)
    finalHTML += std::<span class="hljs-built_in">visit</span>(callBuildHTML, label) + <span class="hljs-string">'\n'</span>;</code></pre><p>Смотрите пример на <a href="https://wandbox.org/permlink/YXLR8D0i12mi0dlF">@Wandbox.</a></p><h4>Дополнительные примеры</h4><p>У меня также есть еще одна статья, где я экспериментировал со своим старым проектом и заменил кучу производных классов на подход <code>std::variant</code>.</p><p>Взгляните при случае:</p><p><a href="https://www.bfilipek.com/2020/09/replacing-into-variant.html#problem-passing-arguments">Замена unique_ptr на std::variant из C++17 - эксперимент</a> на практике</p><h3>Производительность</h3><p>Еще один важный вопрос, которым вы, возможно, в первую очередь зададитесь, касается производительности этой новой техники.</p><p>Является ли <code>std::visit</code> быстрее, чем виртуальная диспетчеризация?</p><p>Давайте выясним.</p><p>Когда я создал простой бенчмарк для моего примера с <code>ILabel</code>, я не заметил никакой разницы.</p><p>Вы можете посмотреть бенчмарк здесь <a href="http://quick-bench.com/nYqkvPMs9qVzlxDfxLwH38WWkMg">@QuickBench.</a></p><p>Я полагаю, что обработка строк имеет достаточно высокую стоимость по сравнению с выполнением всего остального кода; кроме того, в данном варианте не так много типов, что делает фактический вызов очень похожим.</p><p>Но у меня есть другой бенчмарк, в котором используется система частиц.</p><pre><code class="cpp hljs"><span class="hljs-keyword">using</span> ABC = std::variant&lt;AParticle, BParticle, CParticle&gt;;
<span class="hljs-function">std::vector&lt;ABC&gt; <span class="hljs-title">particles</span><span class="hljs-params">(PARTICLE_COUNT)</span></span>;

<span class="hljs-keyword">for</span> (std::<span class="hljs-keyword">size_t</span> i = <span class="hljs-number">0</span>; <span class="hljs-keyword">auto</span>&amp; p : particles) {
  <span class="hljs-built_in"><span class="hljs-keyword">switch</span></span> (i%<span class="hljs-number">3</span>) {
    <span class="hljs-keyword">case</span> <span class="hljs-number">0</span>: p = <span class="hljs-built_in">AParticle</span>(); <span class="hljs-keyword">break</span>;
    <span class="hljs-keyword">case</span> <span class="hljs-number">1</span>: p = <span class="hljs-built_in">BParticle</span>(); <span class="hljs-keyword">break</span>;
    <span class="hljs-keyword">case</span> <span class="hljs-number">2</span>: p = <span class="hljs-built_in">CParticle</span>(); <span class="hljs-keyword">break</span>;
  }
  ++i;
}

<span class="hljs-keyword">auto</span> CallGenerate = [](<span class="hljs-keyword">auto</span>&amp; p) { p.<span class="hljs-built_in">generate</span>(); };
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">auto</span> _ : state) {
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">auto</span>&amp; p : particles)
    std::<span class="hljs-built_in">visit</span>(CallGenerate, p);
}</code></pre><p>Класс <code>Particle</code> (и его версии AParticle, BParticle и т. д.) использует 72 байта данных, и у них есть метод <code>Generate()</code>, который является «виртуальным».</p><p>И на этот раз я получил 10% за улучшение для версии с <code>std::visit</code>!</p><figure class="full-width "><img src="./Динамический полиморфизм с использованием std__variant и std__visit _ Хабр_files/4dd6c2662383b67921a9fe58c3b56765.png" width="900" height="556" data-src="https://habrastorage.org/getpro/habr/upload_files/4dd/6c2/662/4dd6c2662383b67921a9fe58c3b56765.png"><figcaption></figcaption></figure><p>Так почему код может быть быстрее? Я думаю, здесь может быть несколько причин:</p><ul><li><p>Версия с variant не использует динамическое распределение памяти, поэтому все частицы находятся в одном блоке памяти. ЦП могут использовать это для повышения производительности.</p></li></ul><ul><li><p>В зависимости от количества типов может случиться так, что среда выполнения, если она используется для проверки текущего активного типа в варианте, намного быстрее и более предсказуема для компилятора, чем поиск указателя в v-таблице.</p></li></ul><p>Вот еще один бенчмакр, который показывает, что версия с variant на 20% медленнее, чем вектор с всего одним типом: <code>td::vector particles(PARTICLE_COUNT);</code>. Смотрите в <a href="http://quick-bench.com/op4OzjWFZ7OyY691aHzbREDmjWk">QuickBench</a></p><h4>Другие результаты производительности</h4><p>Мой тест был относительно простым и не мог безапелляционно утверждать, что <code>std::visit</code> всегда быстрее. Но для лучшего понимания вы можете взглянуть на <a href="https://www.youtube.com/watch?v=gKbORJtnVu8">эту</a> отличную презентацию от Матеуша Пуша, который реализовал целую машину состояний TCPIP и добился гораздо большей производительности с помощью <code>std::visit</code>. Время выполнения также было более стабильным и предсказуемым, чем виртуальные вызовы.</p><iframe frameborder="0" scrolling="no" allowfullscreen="true" src="./Динамический полиморфизм с использованием std__variant и std__visit _ Хабр_files/6047628596f977d25608ba92.html" style="" width="" id="6047628596f977d25608ba92" height="436"></iframe><p><a href="https://www.youtube.com/watch?v=gKbORJtnVu8"><em>CppCon 2018: Матеуш Пуш «Эффективная замена динамического полиморфизма на std::variant»</em></a></p><h4>Раздувание кода и время сборки</h4><p>Есть также опасения по поводу раздувания кода, которое может возникнуть из-за <code>std::visit</code>. Поскольку эта функция является чистой библиотечной реализацией без дополнительной поддержки со стороны языка, мы можем смело ожидать, что она добавит дополнительные байты в наш исполняемый файл.</p><p>Если вас заботит эта проблема, вам следует взглянуть на следующие ссылки:</p><ul><li><p><a href="https://mpark.github.io/programming/2019/01/22/variant-visitation-v2/">Явление вариантов V2 – Майкл Парк</a></p></li><li><p>Раздувание кода из-за <a href="https://www.reddit.com/r/cpp/comments/9khij8/stdvariant_code_bloat_looks_like_its_stdvisit/">std::variant? Похоже это вина std::visit fault : r/cpp</a></p></li><li><p>Раздувание кода из-за <a href="https://www.reddit.com/r/cpp/comments/9mxvw5/stdvariant_code_bloat_looks_like_its_stdvisit/">std::variant? Похоже это вина std::visit fault (Part 2) : r/cpp</a></p></li></ul><p>Также стоит помнить, что библиотечное решение работает со всем многообразием <code>std::variant</code>, даже с множеством переданных вариантов, поэтому вы платите за эту «общую» поддержку . Если вас не устраивает производительность библиотеки и у вас ограниченный набор вариантов использования, вы можете откатить свою реализацию и посмотреть, улучшит ли это ваш код.</p><h4>Производительность сборки при использовании std::visit и std::variant</h4><p>Я показал вам некоторые цифры с производительностью во время выполнения, но у нас также есть инструмент, который позволяет нам проверить скорость компиляции этих двух подходов.</p><p>Ищите их здесь <a href="https://build-bench.com/b/gW_QHAF4nGnHVmMszzMj_Ja4Oig">@BuildBench</a></p><p>И результаты: GCC 10.1, C++17, O2:</p><figure class="full-width "><img src="./Динамический полиморфизм с использованием std__variant и std__visit _ Хабр_files/eb2f1e3aaf7900bcf999cea39e133aeb.png" width="935" height="520" data-src="https://habrastorage.org/getpro/habr/upload_files/eb2/f1e/3aa/eb2f1e3aaf7900bcf999cea39e133aeb.png"><figcaption></figcaption></figure><p>Так что это почти то же самое! Что касается предварительно обработанных строк, оно еще меньше для вариантной версии — 39k против 44k. Что касается ассемблера, то это 2790 LOC для вариантной версии и 1945 LOC для виртуальной.</p><p>Извините за небольшое отступление от темы.</p><p>Я приготовил для вас небольшой бонус, если вам интересен современный C++, <a href="https://us8.list-manage.com/subscribe?u=e93417593cbf4da3dba03d672&amp;id=b7dee14c64">приглашаю вас сюда.</a></p><h3>Резюме</h3><p>В статье мы рассмотрели новую технику реализации динамического полиморфизма. С помощью <code>std::variant</code> мы можем описать объект, который может иметь много разных типов — например, типобезопасное объединение с семантикой значений. А затем с помощью <code>std::visit</code> мы можем вызвать объект посетителя, который вызовет операцию на основе активного типа в варианте, что позволяет иметь разнородные коллекции и вызывать функции аналогично виртуальным функциям.</p><p>Но разве полиморфизм на основе <code>std::variant</code> лучше обычного «виртуального» полиморфизма? Нет однозначного ответа, поскольку у обоих техник есть свои сильные и слабые стороны. Например, с <code>std::variant</code> вам нужно заранее знать все возможные типы, что может быть невозможно, когда вы пишете общую библиотеку или какую-то систему плагинов. Но, с другой стороны, <code>std::variant</code> предлагает семантику значений, которая может улучшить производительность системы и уменьшить необходимость использования динамической аллокации.</p><p>Я также получил отличное резюме от людей, которые использовали такой код в продакшене. Вот один замечательный комментарий от Бориса Дж. (Смотрите <a href="https://github.com/borysjelenski">его профиль на Github</a>):</p><blockquote><p>Некоторое время назад я использовал std::variant/std::visit для реализации обработки различных типов команд во встроенной системе. В вариантах хорошо то, что полиморфизм работает без косвенного обращения - вам не нужен указатель или ссылка, как в случае с виртуальными функциями. Это помогает в тех случаях, когда объект необходимо создать в функции, а затем вернуть из нее. Я часто пишу код вообще не использующий кучу/динамическую память, поэтому я не могу просто создать объект динамически внутри функции, а затем передать право владения вверх. С variant я могу просто вернуть его по значению (при условии, что оно достаточно мало) без потери полиморфизма.</p><p>С другой стороны, используя их в качестве техники ветвления на основе типов, я обнаружил, что когда вы перемещаете их (в общем смысле, я не имею в виду move семантику), и вам нужно обрабатывать их на разных этапах, вы в конечном итоге пишете новый тип посетителя каждый раз, когда вам нужно что-то сделать с вариантом. Что еще хуже, иногда способ обработки разных типов в варианте отличается лишь незначительно. В результате вы получаете несколько посетителей, некоторые из которых являются промежуточными и неестественными, каждый из которых имеет несколько отдельных функций-членов для каждого типа варианта. В конце концов, вы снова скатываетесь в старый добрый callback hell. Конечно, вы можете использовать конструкцию перегрузки лямбды, но это не сильно меняет дело.</p></blockquote><p>А как насчет вас:</p><ul><li><p>Использовали ли вы <code>std::variant</code> и <code>std::visit</code>?</p></li></ul><ul><li><p>Вы использовали их в продакшене или просто в своем небольшом проекте?</p></li></ul><p>Поделитесь своим опытом в комментариях ниже.</p><hr><blockquote><p><strong><em>Узнать подробнее о курсе </em></strong><a href="https://otus.pw/vYZR/"><strong><em>"C++ Developer. Professional"</em></strong></a><strong><em>.</em></strong></p><p><strong><em>Смотреть открытый вебинар по теме </em></strong><a href="https://otus.pw/6if1/"><strong><em>«Области видимости и невидимости».</em></strong></a><strong><em> </em></strong></p></blockquote></div></div></div> <div class="v-portal" style="display: none;"></div> <div class="v-portal" style="display: none;"></div></div> <div aria-hidden="true" role="dialog" tabindex="-1" class="pswp"><div class="pswp__bg"></div> <div class="pswp__scroll-wrap"><div class="pswp__container"><div class="pswp__item"></div> <div class="pswp__item"></div> <div class="pswp__item"></div></div> <div class="pswp__ui pswp__ui--hidden"><div class="pswp__top-bar"><span class="tm-svg-icon__wrapper pswp__button pswp__button--close"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Закрыть</title> <use xlink:href="/img/megazord-v28.c350aa68..svg#close"></use></svg></span> <div class="pswp__preloader"><div class="pswp__preloader__icn"><div class="pswp__preloader__cut"><div class="pswp__preloader__donut"></div></div></div></div></div> <button class="pswp__button pswp__button--arrow--left"><svg viewBox="0 0 24 24" class="pswp__button-icon"><path fill-rule="evenodd" clip-rule="evenodd" d="M15.707 4.293a1 1 0 010 1.414L9.414 12l6.293 6.293a1 1 0 01-1.414 1.414l-7-7a1 1 0 010-1.414l7-7a1 1 0 011.414 0z"></path></svg></button> <button class="pswp__button pswp__button--arrow--right"><svg viewBox="0 0 24 24" class="pswp__button-icon"><path fill-rule="evenodd" clip-rule="evenodd" d="M15.707 4.293a1 1 0 010 1.414L9.414 12l6.293 6.293a1 1 0 01-1.414 1.414l-7-7a1 1 0 010-1.414l7-7a1 1 0 011.414 0z"></path></svg></button></div></div></div> <!----></div> <!----> <div class="tm-article-presenter__meta"><div class="tm-separated-list tm-article-presenter__meta-list"><span class="tm-separated-list__title">Теги:</span> <ul class="tm-separated-list__list"><li class="tm-separated-list__item"><a href="https://habr.com/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5Bcplusplus%5D" class="tm-tags-list__link">cplusplus</a></li><li class="tm-separated-list__item"><a href="https://habr.com/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5B%D0%B4%D0%B8%D0%BD%D0%B0%D0%BC%D0%B8%D1%87%D0%B5%D1%81%D0%BA%D0%B8%D0%B9%20%D0%BF%D0%BE%D0%BB%D0%B8%D0%BC%D0%BE%D1%80%D1%84%D0%B8%D0%B7%D0%BC%5D" class="tm-tags-list__link">динамический полиморфизм</a></li></ul></div> <div class="tm-separated-list tm-article-presenter__meta-list"><span class="tm-separated-list__title">Хабы:</span> <ul class="tm-separated-list__list"><li class="tm-separated-list__item"><a href="https://habr.com/ru/company/otus/blog/" class="tm-hubs-list__link router-link-active">Блог компании OTUS</a></li><li class="tm-separated-list__item"><a href="https://habr.com/ru/hub/programming/" class="tm-hubs-list__link">Программирование</a></li><li class="tm-separated-list__item"><a href="https://habr.com/ru/hub/cpp/" class="tm-hubs-list__link">C++</a></li></ul></div></div></article></div> <!----></div> <div class="tm-article-sticky-panel" style="display: none;"><div class="tm-data-icons tm-article-sticky-panel__icons"><div class="tm-article-rating tm-data-icons__item"><div class="tm-votes-meter tm-article-rating__votes-switcher"><svg height="24" width="24" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon tm-votes-meter__icon_appearance-article"><title>Всего голосов 16: ↑14 и ↓2</title> <use xlink:href="/img/megazord-v28.c350aa68..svg#counter-rating"></use></svg> <span title="Всего голосов 16: ↑14 и ↓2" class="tm-votes-meter__value tm-votes-meter__value tm-votes-meter__value_positive tm-votes-meter__value_appearance-article tm-votes-meter__value_rating">+12</span></div> <div class="v-portal" style="display:none;"></div></div> <!----> <!----> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-data-icons__item"><span class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="24" width="24" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v28.c350aa68..svg#counter-favorite"></use></svg></span> <span title="Количество пользователей, добавивших публикацию в закладки" class="bookmarks-button__counter">
    46
  </span></button> <div title="Поделиться" class="tm-sharing tm-data-icons__item"><button type="button" class="tm-sharing__button"><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="tm-sharing__icon"><path fill="currentColor" d="M13.8 13.8V18l7.2-6.6L13.8 5v3.9C5 8.9 3 18.6 3 18.6c2.5-4.4 6-4.8 10.8-4.8z"></path></svg></button> <div class="v-portal" style="display:none;"></div></div> <div title="Читать комментарии" class="tm-article-comments-counter-link tm-data-icons__item"><a href="https://habr.com/ru/company/otus/blog/546158/comments/" class="tm-article-comments-counter-link__link"><svg height="24" width="24" class="tm-svg-img tm-article-comments-counter-link__icon"><title>Комментарии</title> <use xlink:href="/img/megazord-v28.c350aa68..svg#counter-comments"></use></svg> <span class="tm-article-comments-counter-link__value">
      4
    </span></a> <!----></div> <!----> <div class="v-portal" style="display:none;"></div></div></div></div>  <div class="tm-article-presenter__footer"><div class="tm-article-blocks"><div class="tm-editoral-subscription"><span class="tm-svg-icon__wrapper tm-editoral-subscription__close"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Закрыть</title> <use xlink:href="/img/megazord-v28.c350aa68..svg#close"></use></svg></span> <h3 class="tm-editoral-subscription__title">
    Редакторский дайджест
  </h3> <p class="tm-editoral-subscription__description">
    Присылаем лучшие статьи раз&nbsp;в&nbsp;месяц
  </p> <form method="GET" class="tm-editoral-subscription__form"><div class="tm-input-text-decorated tm-editoral-subscription__input tm-input-text-decorated_has-label-after" name="email" placeholder="Электропочта" type="email"><!----> <input name="email" placeholder="Электропочта" type="email" class="tm-input-text-decorated__input"> <div class="tm-input-text-decorated__label tm-input-text-decorated__label_after"><button type="submit" class="tm-editoral-subscription__icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path fill="currentColor" clip-rule="evenodd" d="M19.707 11.293a1 1 0 010 1.414l-5.5 5.5a1 1 0 01-1.414-1.414L16.586 13H5a1 1 0 110-2h11.586l-3.793-3.793a1 1 0 011.414-1.414l5.5 5.5z"></path></svg></button></div></div> <!----></form></div> <div></div> <section class="tm-block tm-block tm-block_spacing-bottom"><!----> <div class="tm-block__body tm-block__body tm-block__body_variant-balanced"><div class="tm-article-author"><div class="tm-article-author__company"><div class="tm-article-author__company-card"><div class="tm-company-snippet"><a href="https://habr.com/ru/company/otus/profile/" class="tm-company-snippet__logo-link"><div class="tm-entity-image"><img alt="" height="40" src="./Динамический полиморфизм с использованием std__variant и std__visit _ Хабр_files/2d50edb57cf45fa07cc4f39f53b78395.png" width="40" class="tm-entity-image__pic"></div></a> <div class="tm-company-snippet__info"><a href="https://habr.com/ru/company/otus/profile/" class="tm-company-snippet__title">OTUS</a> <div class="tm-company-snippet__description">Цифровые навыки от ведущих экспертов</div></div></div> <div class="tm-article-author__buttons"><!----> <!----></div></div> <div class="tm-article-author__company-contacts"><a href="https://otus.ru/" rel="noopener" target="_blank" class="tm-article-author__contact">
      Сайт
    </a><a href="https://vk.com/club145052891" rel="noopener" target="_blank" class="tm-article-author__contact">
      ВКонтакте
    </a><a href="https://telegram.me/Otusjava" rel="noopener" target="_blank" class="tm-article-author__contact">
      Telegram
    </a></div> <div class="tm-article-author__separator"></div></div> <div class="tm-user-card tm-article-author__user-card tm-user-card tm-user-card_variant-article"><div class="tm-user-card__info-container"><div class="tm-user-card__header"><div class="tm-user-card__header-data"><a href="https://habr.com/ru/users/MaxRokatansky/" class="tm-user-card__userpic tm-user-card__userpic_size-40"><div class="tm-entity-image"><img alt="" src="./Динамический полиморфизм с использованием std__variant и std__visit _ Хабр_files/b9fbaf5f96ae52973706a0716bd9216e(1).jpg" class="tm-entity-image__pic"></div></a> <div class="tm-user-card__meta"><div title=" 871 голос " class="tm-counter-container tm-karma tm-karma"><div class="tm-counter-container__header"><div class="tm-karma__votes tm-karma__votes_positive">
      55
    </div></div> <div class="tm-counter-container__footer"><div class="tm-karma__text">
      Карма
    </div> <div class="v-portal" style="display:none;"></div></div></div> <div title="Рейтинг пользователя" class="tm-counter-container"><div class="tm-counter-container__header"> <div class="tm-votes-lever tm-votes-lever tm-votes-lever_appearance-rating"><!----> <div class="tm-votes-lever__score tm-votes-lever__score tm-votes-lever__score_appearance-rating"><span class="tm-votes-lever__score-counter tm-votes-lever__score-counter tm-votes-lever__score-counter_rating">
        174.9
      </span></div> <!----></div></div> <div class="tm-counter-container__footer"><span class="tm-rating__text tm-rating__text">
      Рейтинг
    </span></div></div></div></div></div> <div class="tm-user-card__info tm-user-card__info tm-user-card__info_variant-article"><div class="tm-user-card__title tm-user-card__title tm-user-card__title_variant-article"><span class="tm-user-card__name tm-user-card__name tm-user-card__name_variant-article">OTUS</span> <a href="https://habr.com/ru/users/MaxRokatansky/" class="tm-user-card__nickname tm-user-card__nickname tm-user-card__nickname_variant-article">
          @MaxRokatansky
        </a> <!----></div> <p class="tm-user-card__short-info tm-user-card__short-info tm-user-card__short-info_variant-article">Редактор</p></div></div> <div class="tm-user-card__buttons tm-user-card__buttons tm-user-card__buttons_variant-article"><!----> <!----> <!----> <!----> <!----></div></div> <!----></div> <div class="v-portal" style="display:none;"></div></div> <!----></section>  <div class="tm-article-blocks__comments"><div class="tm-article-page-comments"><div class="tm-article-comments-counter-link tm-article-comments-counter-button"><a href="https://habr.com/ru/company/otus/blog/546158/comments/" class="tm-article-comments-counter-link__link tm-article-comments-counter-link__link_button-style"><svg height="24" width="24" class="tm-svg-img tm-article-comments-counter-link__icon tm-article-comments-counter-link__icon_contrasted"><title>Комментарии</title> <use xlink:href="/img/megazord-v28.c350aa68..svg#counter-comments"></use></svg> <span class="tm-article-comments-counter-link__value tm-article-comments-counter-link__value_contrasted">
       Комментарии 4 
    </span></a> <!----></div></div></div>  <section class="tm-block tm-block tm-block_spacing-bottom"><header class="tm-block__header tm-block__header tm-block__header_variant-borderless"><div class="tm-block__header-container"><h2 class="tm-block__title tm-block__title tm-block__title_variant-large">Публикации</h2> </div> <!----></header> <div class="tm-block__body tm-block__body tm-block__body_variant-condensed-slim"><div class="tm-tabs tm-tabs"><div class=""><span class="tm-tabs__tab-item"><button class="tm-tabs__tab-link tm-tabs__tab-link tm-tabs__tab-link_active tm-tabs__tab-link_slim">
        Лучшие за сутки
      </button></span><span class="tm-tabs__tab-item"><button class="tm-tabs__tab-link tm-tabs__tab-link tm-tabs__tab-link_slim">
        Похожие
      </button></span></div> <!----></div> <div class="similar-and-daily__tab-view"><div class="daily-articles-list"><ul class="tm-article-card-list"><li class="tm-bordered-card"><!----> <div class="tm-article-snippet tm-article-snippet tm-article-snippet_noBorder"><div class="tm-article-snippet__meta-container"><div class="tm-article-snippet__meta"><span class="tm-user-info tm-article-snippet__author"><a href="https://habr.com/ru/users/MichaelSkirda/" class="tm-user-info__userpic" title="MichaelSkirda"><div class="tm-entity-image"><img alt="" height="24" src="./Динамический полиморфизм с использованием std__variant и std__visit _ Хабр_files/e65db265c065e2ec66a5e8a8e60d0cd8.png" width="24" class="tm-entity-image__pic"></div></a> <span class="tm-user-info__user"><a href="https://habr.com/ru/users/MichaelSkirda/" class="tm-user-info__username">
      MichaelSkirda
      <!----></a> <span class="tm-article-datetime-published"><time datetime="2023-04-01T15:17:54.000Z" title="2023-04-01, 18:17">17 часов назад</time></span></span></span></div> <!----></div> <h2 lang="ru" class="tm-title tm-title_h2"><a href="https://habr.com/ru/post/726356/" class="tm-title__link" data-test-id="article-snippet-title-link" data-article-link="true"><span>Все новые функции C# 13 | Что нового в .NET 10, почему нет .NET 9</span></a></h2> <div class="tm-article-snippet__stats"><!----> <div class="tm-article-reading-time"><span class="tm-svg-icon__wrapper tm-article-reading-time__icon"><svg height="24" width="24" class="tm-svg-img tm-svg-icon"><title>Время на прочтение</title> <use xlink:href="/img/megazord-v28.c350aa68..svg#clock"></use></svg></span> <span class="tm-article-reading-time__label">
    3 мин
  </span></div> <span class="tm-icon-counter tm-data-icons__item"><svg height="24" width="24" class="tm-svg-img tm-icon-counter__icon"><title>Количество просмотров</title> <use xlink:href="/img/megazord-v28.c350aa68..svg#counter-views"></use></svg> <span class="tm-icon-counter__value">6.2K</span></span></div> <!----> <div class="tm-article-snippet__labels-container"><div class="tm-article-snippet__labels"><div class="tm-article-snippet__label tm-article-snippet__label_variant-review"><span>
          Обзор
        </span></div> </div></div> <!----> <!----></div> <div class="tm-data-icons"><!----> <div class="tm-votes-meter tm-data-icons__item"><svg height="24" width="24" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon tm-votes-meter__icon_appearance-article"><title>Всего голосов 69: ↑64 и ↓5</title> <use xlink:href="/img/megazord-v28.c350aa68..svg#counter-rating"></use></svg> <span title="Всего голосов 69: ↑64 и ↓5" class="tm-votes-meter__value tm-votes-meter__value tm-votes-meter__value_positive tm-votes-meter__value_appearance-article tm-votes-meter__value_rating">+59</span></div> <!----> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-data-icons__item"><span class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="24" width="24" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v28.c350aa68..svg#counter-favorite"></use></svg></span> <span title="Количество пользователей, добавивших публикацию в закладки" class="bookmarks-button__counter">
    23
  </span></button> <!----> <div class="tm-article-comments-counter-link tm-data-icons__item" title="Читать комментарии"><a href="https://habr.com/ru/post/726356/comments/" class="tm-article-comments-counter-link__link"><svg height="24" width="24" class="tm-svg-img tm-article-comments-counter-link__icon"><title>Комментарии</title> <use xlink:href="/img/megazord-v28.c350aa68..svg#counter-comments"></use></svg> <span class="tm-article-comments-counter-link__value">
      37
    </span></a> <a href="https://habr.com/ru/post/726356/comments/" class="tm-article-comments-counter-link__link"><div title="Читать новые комментарии" class="tm-article-comments-counter-link__unread-counter"><span>+37</span></div></a></div>  <div class="v-portal" style="display: none;"></div></div></li><li class="tm-bordered-card"><!----> <div class="tm-article-snippet tm-article-snippet tm-article-snippet_noBorder"><div class="tm-article-snippet__meta-container"><div class="tm-article-snippet__meta"><span class="tm-user-info tm-article-snippet__author"><a href="https://habr.com/ru/users/Erwinmal/" class="tm-user-info__userpic" title="Erwinmal"><div class="tm-entity-image"><img alt="" height="24" src="./Динамический полиморфизм с использованием std__variant и std__visit _ Хабр_files/ed965970f791e09dfe69376568394582.jpg" width="24" class="tm-entity-image__pic"></div></a> <span class="tm-user-info__user"><a href="https://habr.com/ru/users/Erwinmal/" class="tm-user-info__username">
      Erwinmal
      <!----></a> <span class="tm-article-datetime-published"><time datetime="2023-04-01T10:00:01.000Z" title="2023-04-01, 13:00">22 часа назад</time></span></span></span></div> <!----></div> <h2 lang="ru" class="tm-title tm-title_h2"><a href="https://habr.com/ru/company/ruvds/blog/726278/" class="tm-title__link" data-test-id="article-snippet-title-link" data-article-link="true"><span>Самые криповые случаи с ИИ: всё даже более стрёмно, чем казалось! Часть 2</span></a></h2> <div class="tm-article-snippet__stats"><div class="tm-article-complexity tm-article-complexity_complexity-low"><span class="tm-svg-icon__wrapper tm-article-complexity__icon"><svg height="24" width="24" class="tm-svg-img tm-svg-icon"><title>Уровень сложности</title> <use xlink:href="/img/megazord-v28.c350aa68..svg#complexity-low"></use></svg></span> <span class="tm-article-complexity__label">
    Простой
  </span></div> <div class="tm-article-reading-time"><span class="tm-svg-icon__wrapper tm-article-reading-time__icon"><svg height="24" width="24" class="tm-svg-img tm-svg-icon"><title>Время на прочтение</title> <use xlink:href="/img/megazord-v28.c350aa68..svg#clock"></use></svg></span> <span class="tm-article-reading-time__label">
    19 мин
  </span></div> <span class="tm-icon-counter tm-data-icons__item"><svg height="24" width="24" class="tm-svg-img tm-icon-counter__icon"><title>Количество просмотров</title> <use xlink:href="/img/megazord-v28.c350aa68..svg#counter-views"></use></svg> <span class="tm-icon-counter__value">15K</span></span></div> <!----> <!----> <!----> <!----></div> <div class="tm-data-icons"><!----> <div class="tm-votes-meter tm-data-icons__item"><svg height="24" width="24" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon tm-votes-meter__icon_appearance-article"><title>Всего голосов 61: ↑53 и ↓8</title> <use xlink:href="/img/megazord-v28.c350aa68..svg#counter-rating"></use></svg> <span title="Всего голосов 61: ↑53 и ↓8" class="tm-votes-meter__value tm-votes-meter__value tm-votes-meter__value_positive tm-votes-meter__value_appearance-article tm-votes-meter__value_rating">+45</span></div> <!----> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-data-icons__item"><span class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="24" width="24" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v28.c350aa68..svg#counter-favorite"></use></svg></span> <span title="Количество пользователей, добавивших публикацию в закладки" class="bookmarks-button__counter">
    42
  </span></button> <!----> <div class="tm-article-comments-counter-link tm-data-icons__item" title="Читать комментарии"><a href="https://habr.com/ru/company/ruvds/blog/726278/comments/" class="tm-article-comments-counter-link__link"><svg height="24" width="24" class="tm-svg-img tm-article-comments-counter-link__icon"><title>Комментарии</title> <use xlink:href="/img/megazord-v28.c350aa68..svg#counter-comments"></use></svg> <span class="tm-article-comments-counter-link__value">
      72
    </span></a> <a href="https://habr.com/ru/company/ruvds/blog/726278/comments/" class="tm-article-comments-counter-link__link"><div title="Читать новые комментарии" class="tm-article-comments-counter-link__unread-counter"><span>+72</span></div></a></div>  <div class="v-portal" style="display: none;"></div></div></li><li class="tm-bordered-card"><!----> <div class="tm-article-snippet tm-article-snippet tm-article-snippet_noBorder"><div class="tm-article-snippet__meta-container"><div class="tm-article-snippet__meta"><span class="tm-user-info tm-article-snippet__author"><a href="https://habr.com/ru/users/Exosphere/" class="tm-user-info__userpic" title="Exosphere"><div class="tm-entity-image"><img alt="" height="24" src="./Динамический полиморфизм с использованием std__variant и std__visit _ Хабр_files/387c3035e3a22a0b918b4cb0616b34e3.jpg" width="24" class="tm-entity-image__pic"></div></a> <span class="tm-user-info__user"><a href="https://habr.com/ru/users/Exosphere/" class="tm-user-info__username">
      Exosphere
      <!----></a> <span class="tm-article-datetime-published"><time datetime="2023-04-01T18:10:56.000Z" title="2023-04-01, 21:10">14 часов назад</time></span></span></span></div> <!----></div> <h2 lang="ru" class="tm-title tm-title_h2"><a href="https://habr.com/ru/post/726366/" class="tm-title__link" data-test-id="article-snippet-title-link" data-article-link="true"><span>Где решать задачи по программированию, чтобы пройти путь from zero to hero</span></a></h2> <div class="tm-article-snippet__stats"><div class="tm-article-complexity tm-article-complexity_complexity-low"><span class="tm-svg-icon__wrapper tm-article-complexity__icon"><svg height="24" width="24" class="tm-svg-img tm-svg-icon"><title>Уровень сложности</title> <use xlink:href="/img/megazord-v28.c350aa68..svg#complexity-low"></use></svg></span> <span class="tm-article-complexity__label">
    Простой
  </span></div> <div class="tm-article-reading-time"><span class="tm-svg-icon__wrapper tm-article-reading-time__icon"><svg height="24" width="24" class="tm-svg-img tm-svg-icon"><title>Время на прочтение</title> <use xlink:href="/img/megazord-v28.c350aa68..svg#clock"></use></svg></span> <span class="tm-article-reading-time__label">
    4 мин
  </span></div> <span class="tm-icon-counter tm-data-icons__item"><svg height="24" width="24" class="tm-svg-img tm-icon-counter__icon"><title>Количество просмотров</title> <use xlink:href="/img/megazord-v28.c350aa68..svg#counter-views"></use></svg> <span class="tm-icon-counter__value">4.8K</span></span></div> <!----> <div class="tm-article-snippet__labels-container"><div class="tm-article-snippet__labels"><div class="tm-article-snippet__label tm-article-snippet__label_variant-digest"><span>
          Дайджест
        </span></div> </div></div> <!----> <!----></div> <div class="tm-data-icons"><!----> <div class="tm-votes-meter tm-data-icons__item"><svg height="24" width="24" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon tm-votes-meter__icon_appearance-article"><title>Всего голосов 30: ↑30 и ↓0</title> <use xlink:href="/img/megazord-v28.c350aa68..svg#counter-rating"></use></svg> <span title="Всего голосов 30: ↑30 и ↓0" class="tm-votes-meter__value tm-votes-meter__value tm-votes-meter__value_positive tm-votes-meter__value_appearance-article tm-votes-meter__value_rating">+30</span></div> <!----> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-data-icons__item"><span class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="24" width="24" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v28.c350aa68..svg#counter-favorite"></use></svg></span> <span title="Количество пользователей, добавивших публикацию в закладки" class="bookmarks-button__counter">
    157
  </span></button> <!----> <div class="tm-article-comments-counter-link tm-data-icons__item" title="Читать комментарии"><a href="https://habr.com/ru/post/726366/comments/" class="tm-article-comments-counter-link__link"><svg height="24" width="24" class="tm-svg-img tm-article-comments-counter-link__icon"><title>Комментарии</title> <use xlink:href="/img/megazord-v28.c350aa68..svg#counter-comments"></use></svg> <span class="tm-article-comments-counter-link__value">
      12
    </span></a> <a href="https://habr.com/ru/post/726366/comments/" class="tm-article-comments-counter-link__link"><div title="Читать новые комментарии" class="tm-article-comments-counter-link__unread-counter"><span>+12</span></div></a></div>  <div class="v-portal" style="display: none;"></div></div></li><li class="tm-bordered-card"><!----> <div class="tm-article-snippet tm-article-snippet tm-article-snippet_noBorder"><div class="tm-article-snippet__meta-container"><div class="tm-article-snippet__meta"><span class="tm-user-info tm-article-snippet__author"><a href="https://habr.com/ru/users/TLHE/" class="tm-user-info__userpic" title="TLHE"><div class="tm-entity-image"><img alt="" height="24" src="./Динамический полиморфизм с использованием std__variant и std__visit _ Хабр_files/8969192d0b3a153f7abdb22cfb1effb9.jpg" width="24" class="tm-entity-image__pic"></div></a> <span class="tm-user-info__user"><a href="https://habr.com/ru/users/TLHE/" class="tm-user-info__username">
      TLHE
      <!----></a> <span class="tm-article-datetime-published"><time datetime="2023-04-01T14:01:01.000Z" title="2023-04-01, 17:01">18 часов назад</time></span></span></span></div> <!----></div> <h2 lang="ru" class="tm-title tm-title_h2"><a href="https://habr.com/ru/company/timeweb/blog/725136/" class="tm-title__link" data-test-id="article-snippet-title-link" data-article-link="true"><span>Постпятничные клеточные автоматы: альтернативные окрестности и HROT</span></a></h2> <div class="tm-article-snippet__stats"><div class="tm-article-complexity tm-article-complexity_complexity-low"><span class="tm-svg-icon__wrapper tm-article-complexity__icon"><svg height="24" width="24" class="tm-svg-img tm-svg-icon"><title>Уровень сложности</title> <use xlink:href="/img/megazord-v28.c350aa68..svg#complexity-low"></use></svg></span> <span class="tm-article-complexity__label">
    Простой
  </span></div> <div class="tm-article-reading-time"><span class="tm-svg-icon__wrapper tm-article-reading-time__icon"><svg height="24" width="24" class="tm-svg-img tm-svg-icon"><title>Время на прочтение</title> <use xlink:href="/img/megazord-v28.c350aa68..svg#clock"></use></svg></span> <span class="tm-article-reading-time__label">
    6 мин
  </span></div> <span class="tm-icon-counter tm-data-icons__item"><svg height="24" width="24" class="tm-svg-img tm-icon-counter__icon"><title>Количество просмотров</title> <use xlink:href="/img/megazord-v28.c350aa68..svg#counter-views"></use></svg> <span class="tm-icon-counter__value">991</span></span></div> <!----> <div class="tm-article-snippet__labels-container"><div class="tm-article-snippet__labels"><div class="tm-article-snippet__label tm-article-snippet__label_variant-review"><span>
          Обзор
        </span></div> </div></div> <!----> <!----></div> <div class="tm-data-icons"><!----> <div class="tm-votes-meter tm-data-icons__item"><svg height="24" width="24" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon tm-votes-meter__icon_appearance-article"><title>Всего голосов 25: ↑25 и ↓0</title> <use xlink:href="/img/megazord-v28.c350aa68..svg#counter-rating"></use></svg> <span title="Всего голосов 25: ↑25 и ↓0" class="tm-votes-meter__value tm-votes-meter__value tm-votes-meter__value_positive tm-votes-meter__value_appearance-article tm-votes-meter__value_rating">+25</span></div> <!----> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-data-icons__item"><span class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="24" width="24" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v28.c350aa68..svg#counter-favorite"></use></svg></span> <span title="Количество пользователей, добавивших публикацию в закладки" class="bookmarks-button__counter">
    26
  </span></button> <!----> <div class="tm-article-comments-counter-link tm-data-icons__item" title="Читать комментарии"><a href="https://habr.com/ru/company/timeweb/blog/725136/comments/" class="tm-article-comments-counter-link__link"><svg height="24" width="24" class="tm-svg-img tm-article-comments-counter-link__icon"><title>Комментарии</title> <use xlink:href="/img/megazord-v28.c350aa68..svg#counter-comments"></use></svg> <span class="tm-article-comments-counter-link__value">
      7
    </span></a> <a href="https://habr.com/ru/company/timeweb/blog/725136/comments/" class="tm-article-comments-counter-link__link"><div title="Читать новые комментарии" class="tm-article-comments-counter-link__unread-counter"><span>+7</span></div></a></div>  <div class="v-portal" style="display: none;"></div></div></li><li class="tm-bordered-card"><!----> <div class="tm-article-snippet tm-article-snippet tm-article-snippet_noBorder"><div class="tm-article-snippet__meta-container"><div class="tm-article-snippet__meta"><span class="tm-user-info tm-article-snippet__author"><a href="https://habr.com/ru/users/2Nplus1/" class="tm-user-info__userpic" title="2Nplus1"><div class="tm-entity-image"><svg height="24" width="24" class="tm-svg-img tm-image-placeholder tm-image-placeholder_pink"><!----> <use xlink:href="/img/megazord-v28.c350aa68..svg#placeholder-user"></use></svg></div></a> <span class="tm-user-info__user"><a href="https://habr.com/ru/users/2Nplus1/" class="tm-user-info__username">
      2Nplus1
      <!----></a> <span class="tm-article-datetime-published"><time datetime="2023-04-01T11:18:03.000Z" title="2023-04-01, 14:18">21 час назад</time></span></span></span></div> <!----></div> <h2 lang="ru" class="tm-title tm-title_h2"><a href="https://habr.com/ru/company/dcmiran/blog/726334/" class="tm-title__link" data-test-id="article-snippet-title-link" data-article-link="true"><span>«МИРАН» тестирует ШПД по технологии Aqua Ethernet</span></a></h2> <div class="tm-article-snippet__stats"><!----> <div class="tm-article-reading-time"><span class="tm-svg-icon__wrapper tm-article-reading-time__icon"><svg height="24" width="24" class="tm-svg-img tm-svg-icon"><title>Время на прочтение</title> <use xlink:href="/img/megazord-v28.c350aa68..svg#clock"></use></svg></span> <span class="tm-article-reading-time__label">
    2 мин
  </span></div> <span class="tm-icon-counter tm-data-icons__item"><svg height="24" width="24" class="tm-svg-img tm-icon-counter__icon"><title>Количество просмотров</title> <use xlink:href="/img/megazord-v28.c350aa68..svg#counter-views"></use></svg> <span class="tm-icon-counter__value">2.9K</span></span></div> <!----> <!----> <!----> <!----></div> <div class="tm-data-icons"><!----> <div class="tm-votes-meter tm-data-icons__item"><svg height="24" width="24" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon tm-votes-meter__icon_appearance-article"><title>Всего голосов 29: ↑26 и ↓3</title> <use xlink:href="/img/megazord-v28.c350aa68..svg#counter-rating"></use></svg> <span title="Всего голосов 29: ↑26 и ↓3" class="tm-votes-meter__value tm-votes-meter__value tm-votes-meter__value_positive tm-votes-meter__value_appearance-article tm-votes-meter__value_rating">+23</span></div> <!----> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-data-icons__item"><span class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="24" width="24" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v28.c350aa68..svg#counter-favorite"></use></svg></span> <span title="Количество пользователей, добавивших публикацию в закладки" class="bookmarks-button__counter">
    6
  </span></button> <!----> <div class="tm-article-comments-counter-link tm-data-icons__item" title="Читать комментарии"><a href="https://habr.com/ru/company/dcmiran/blog/726334/comments/" class="tm-article-comments-counter-link__link"><svg height="24" width="24" class="tm-svg-img tm-article-comments-counter-link__icon"><title>Комментарии</title> <use xlink:href="/img/megazord-v28.c350aa68..svg#counter-comments"></use></svg> <span class="tm-article-comments-counter-link__value">
      17
    </span></a> <a href="https://habr.com/ru/company/dcmiran/blog/726334/comments/" class="tm-article-comments-counter-link__link"><div title="Читать новые комментарии" class="tm-article-comments-counter-link__unread-counter"><span>+17</span></div></a></div>  <div class="v-portal" style="display: none;"></div></div></li> <!----></ul> <div class="daily-articles-block__button-container"><button type="button" class="daily-articles-block__button btn btn_transparent btn_small">
      Показать еще
    </button></div></div> <!----></div></div> <!----></section> <!----> <!----> </div></div></div></div></div> <div class="tm-page__sidebar"><div class="tm-layout-sidebar"><div class="tm-layout-sidebar__placeholder_stick-bottom"></div> <div class="tm-sexy-sidebar tm-sexy-sidebar_stick-bottom" style="margin-top: 0px;"><!----> <section class="tm-block tm-block tm-block_spacing-bottom"><header class="tm-block__header tm-block__header"><div class="tm-block__header-container"><h2 class="tm-block__title tm-block__title">Информация</h2> </div> <!----></header> <div class="tm-block__body tm-block__body"><div class="tm-company-basic-info"><dl class="tm-description-list tm-description-list tm-description-list_variant-columns-nowrap"><dt class="tm-description-list__title tm-description-list__title tm-description-list__title_variant-columns-nowrap">Сайт</dt> <dd class="tm-description-list__body tm-description-list__body tm-description-list__body_variant-columns-nowrap"><a href="https://otus.ru/" target="_blank" class="tm-company-basic-info__link">
      otus.ru
    </a></dd></dl> <dl class="tm-description-list tm-description-list tm-description-list_variant-columns-nowrap"><dt class="tm-description-list__title tm-description-list__title tm-description-list__title_variant-columns-nowrap">Дата регистрации</dt> <dd class="tm-description-list__body tm-description-list__body tm-description-list__body_variant-columns-nowrap"><time datetime="2017-03-22T08:17:26.000Z" title="2017-03-22, 11:17">22  марта  2017</time></dd></dl> <dl class="tm-description-list tm-description-list tm-description-list_variant-columns-nowrap"><dt class="tm-description-list__title tm-description-list__title tm-description-list__title_variant-columns-nowrap">Дата основания</dt> <dd class="tm-description-list__body tm-description-list__body tm-description-list__body_variant-columns-nowrap"><time datetime="2017-03-31T21:00:00.000Z" title="2017-04-01, 00:00">1  апреля  2017</time></dd></dl> <dl class="tm-description-list tm-description-list tm-description-list_variant-columns-nowrap"><dt class="tm-description-list__title tm-description-list__title tm-description-list__title_variant-columns-nowrap">Численность</dt> <dd class="tm-description-list__body tm-description-list__body tm-description-list__body_variant-columns-nowrap">
    51–100 человек
  </dd></dl> <dl class="tm-description-list tm-description-list tm-description-list_variant-columns-nowrap"><dt class="tm-description-list__title tm-description-list__title tm-description-list__title_variant-columns-nowrap">Местоположение</dt> <dd class="tm-description-list__body tm-description-list__body tm-description-list__body_variant-columns-nowrap">
    Россия
  </dd></dl> <dl class="tm-description-list tm-description-list tm-description-list_variant-columns-nowrap"><dt class="tm-description-list__title tm-description-list__title tm-description-list__title_variant-columns-nowrap">Представитель</dt> <dd class="tm-description-list__body tm-description-list__body tm-description-list__body_variant-columns-nowrap"><a href="https://habr.com/ru/users/MaxRokatansky/" class="tm-company-basic-info__link">
      OTUS
    </a></dd></dl></div></div> <!----></section> <div class="tm-company-widgets"><aside class="tm-block tm-block tm-block_spacing-bottom" level="2" type="news"><header class="tm-block__header tm-block__header"><div class="tm-block__header-container"><h2 class="tm-block__title tm-block__title">Новости</h2> </div> <!----></header> <div class="tm-block__body tm-block__body"><ul class="tm-widget-news__list"><li class="tm-widget-news__item"><a href="https://t.me/Otusjava/4943" rel="nofollow noreferrer" target="_blank" class="tm-widget-news__link">🔧 OTUS News pinned a photo</a> <small class="tm-widget-news__date"><time datetime="2023-04-01T09:32:35.000Z" title="2023-04-01, 12:32">вчера в 12:32</time></small></li><li class="tm-widget-news__item"><a href="https://t.me/Otusjava/4942" rel="nofollow noreferrer" target="_blank" class="tm-widget-news__link">🖼 ⚡ 1 апреля — день рождения OTUS ⚡ И нет, это не шутка. Нам исполнилось 6 лет! В честь ...</a> <small class="tm-widget-news__date"><time datetime="2023-04-01T09:30:58.000Z" title="2023-04-01, 12:30">вчера в 12:30</time></small></li><li class="tm-widget-news__item"><a href="https://t.me/Otusjava/4941" rel="nofollow noreferrer" target="_blank" class="tm-widget-news__link">[GIF] #Otus_тест 💣 Сегодня на рынке труда знание Clojure — редкий навык, но высокооплачива...</a> <small class="tm-widget-news__date"><time datetime="2023-03-31T08:01:55.000Z" title="2023-03-31, 11:01">31  марта  </time></small></li><li class="tm-widget-news__item"><a href="https://t.me/Otusjava/4940" rel="nofollow noreferrer" target="_blank" class="tm-widget-news__link">🖼 IT — рынок кандидатов с большим опытом и хорошим портфолио. Как в гонке за сильны...</a> <small class="tm-widget-news__date"><time datetime="2023-03-30T13:01:13.000Z" title="2023-03-30, 16:01">30  марта  </time></small></li><li class="tm-widget-news__item"><a href="https://t.me/Otusjava/4930" rel="nofollow noreferrer" target="_blank" class="tm-widget-news__link">🖼 В стандартной библиотеке C++ для управления наборами объектов существуют конте...</a> <small class="tm-widget-news__date"><time datetime="2023-03-29T15:25:43.000Z" title="2023-03-29, 18:25">29  марта  </time></small></li><li class="tm-widget-news__item"><a href="https://t.me/Otusjava/4929" rel="nofollow noreferrer" target="_blank" class="tm-widget-news__link">🖼 #Otus_мемы #itmemes</a> <small class="tm-widget-news__date"><time datetime="2023-03-28T16:44:43.000Z" title="2023-03-28, 19:44">28  марта  </time></small></li><li class="tm-widget-news__item"><a href="https://t.me/Otusjava/4928" rel="nofollow noreferrer" target="_blank" class="tm-widget-news__link">🖼 #Otus_анонс Новая неделя 👉 новый анонс вебинаров в OTUS! 🔥 Записывайтесь и подключ...</a> <small class="tm-widget-news__date"><time datetime="2023-03-27T07:27:51.000Z" title="2023-03-27, 10:27">27  марта  </time></small></li><li class="tm-widget-news__item"><a href="https://t.me/Otusjava/4927" rel="nofollow noreferrer" target="_blank" class="tm-widget-news__link">🖼 В сегодняшней подборке в честь международного дня достижений — собрали биогра...</a> <small class="tm-widget-news__date"><time datetime="2023-03-24T10:45:54.000Z" title="2023-03-24, 13:45">24  марта  </time></small></li><li class="tm-widget-news__item"><a href="https://t.me/Otusjava/4926" rel="nofollow noreferrer" target="_blank" class="tm-widget-news__link">🖼 IT — рынок кандидатов с большим опытом и хорошим портфолио. Компании борются за ...</a> <small class="tm-widget-news__date"><time datetime="2023-03-23T13:28:55.000Z" title="2023-03-23, 16:28">23  марта  </time></small></li><li class="tm-widget-news__item"><a href="https://t.me/Otusjava/4925" rel="nofollow noreferrer" target="_blank" class="tm-widget-news__link">🖼 #Otus_мемы #itmemes</a> <small class="tm-widget-news__date"><time datetime="2023-03-22T13:26:43.000Z" title="2023-03-22, 16:26">22  марта  </time></small></li></ul></div> <!----></aside><section class="tm-block tm-block tm-block_spacing-bottom" type="banner"><header class="tm-block__header tm-block__header tm-block__header_variant-borderless"><div class="tm-block__header-container"><h2 class="tm-block__title tm-block__title">Виджет</h2> </div> <!----></header> <div class="tm-block__body tm-block__body"><div class="tm-widget-banner-content"><a href="https://otus.pw/0sGd/" class="tm-widget-banner-content__image-wrapper"><img alt="" src="./Динамический полиморфизм с использованием std__variant и std__visit _ Хабр_files/c3f006268634497dc6a3d60338ecdfdc.png" class="tm-widget-banner-content__image tm-widget-banner-content__image_align-left"></a> <!----></div></div> <!----></section><section class="tm-block tm-block tm-block_spacing-bottom"><header class="tm-block__header tm-block__header"><div class="tm-block__header-container"><h2 class="tm-block__title tm-block__title">ВКонтакте</h2> </div> <!----></header> <div class="tm-block__body tm-block__body"><script async="async" src="./Динамический полиморфизм с использованием std__variant и std__visit _ Хабр_files/openapi.js.загрузка" type="application/javascript"></script> <div id="widget-social-0.8981171760921556" style="width: 260px; height: 300px; background: none;"><iframe name="fXD5cef6" frameborder="0" src="./Динамический полиморфизм с использованием std__variant и std__visit _ Хабр_files/widget_community.html" width="260" height="300" scrolling="no" id="vkwidget1" style="overflow: hidden; height: 300px;"></iframe></div></div> <!----></section></div> <section class="tm-block tm-block tm-block_spacing-around"><header class="tm-block__header tm-block__header"><div class="tm-block__header-container"><h2 class="tm-block__title tm-block__title">Блог на Хабре</h2> </div> <!----></header> <div class="tm-block__body tm-block__body"><ul class="tm-article-list-block__list"><li class="tm-article-list-block__item"><article class="tm-article-snippet-block-sidebar tm-article-snippet-block-sidebar_preview"><div class="tm-article-snippet-block__user-meta"><div class="tm-article-snippet-block__date"><time datetime="2023-03-31T11:45:11.000Z" title="2023-03-31, 14:45">31  мар   в 14:45</time></div></div> <h2 class="tm-article-title tm-article-title_sidebar"><a href="https://habr.com/ru/company/otus/blog/726128/" class="tm-article-title__link"><span>Как не превратить микросервисы в киберпанк-дистопию</span></a></h2> <div class="tm-data-icons"><!----> <!----> <span class="tm-icon-counter tm-data-icons__item"><svg height="24" width="24" class="tm-svg-img tm-icon-counter__icon"><title>Количество просмотров</title> <use xlink:href="/img/megazord-v28.c350aa68..svg#counter-views"></use></svg> <span class="tm-icon-counter__value">1.7K</span></span> <!----> <!----> <div class="tm-article-comments-counter-link tm-data-icons__item" title="Читать комментарии"><a href="https://habr.com/ru/company/otus/blog/726128/comments/" class="tm-article-comments-counter-link__link"><svg height="24" width="24" class="tm-svg-img tm-article-comments-counter-link__icon"><title>Комментарии</title> <use xlink:href="/img/megazord-v28.c350aa68..svg#counter-comments"></use></svg> <span class="tm-article-comments-counter-link__value">
      0
    </span></a> <!----></div>  <div class="v-portal" style="display: none;"></div></div></article></li><li class="tm-article-list-block__item"><article class="tm-article-snippet-block-sidebar tm-article-snippet-block-sidebar_preview"><div class="tm-article-snippet-block__user-meta"><div class="tm-article-snippet-block__date"><time datetime="2023-03-30T13:11:45.000Z" title="2023-03-30, 16:11">30  мар   в 16:11</time></div></div> <h2 class="tm-article-title tm-article-title_sidebar"><a href="https://habr.com/ru/company/otus/blog/725762/" class="tm-article-title__link"><span>Расширенные шаблоны свойств</span></a></h2> <div class="tm-data-icons"><!----> <!----> <span class="tm-icon-counter tm-data-icons__item"><svg height="24" width="24" class="tm-svg-img tm-icon-counter__icon"><title>Количество просмотров</title> <use xlink:href="/img/megazord-v28.c350aa68..svg#counter-views"></use></svg> <span class="tm-icon-counter__value">1.7K</span></span> <!----> <!----> <div class="tm-article-comments-counter-link tm-data-icons__item" title="Читать комментарии"><a href="https://habr.com/ru/company/otus/blog/725762/comments/" class="tm-article-comments-counter-link__link"><svg height="24" width="24" class="tm-svg-img tm-article-comments-counter-link__icon"><title>Комментарии</title> <use xlink:href="/img/megazord-v28.c350aa68..svg#counter-comments"></use></svg> <span class="tm-article-comments-counter-link__value">
      0
    </span></a> <!----></div>  <div class="v-portal" style="display: none;"></div></div></article></li><li class="tm-article-list-block__item"><article class="tm-article-snippet-block-sidebar tm-article-snippet-block-sidebar_preview"><div class="tm-article-snippet-block__user-meta"><div class="tm-article-snippet-block__date"><time datetime="2023-03-30T12:33:13.000Z" title="2023-03-30, 15:33">30  мар   в 15:33</time></div></div> <h2 class="tm-article-title tm-article-title_sidebar"><a href="https://habr.com/ru/company/otus/blog/725902/" class="tm-article-title__link"><span>HTTP/3 и QUIC: Как это работает?</span></a></h2> <div class="tm-data-icons"><!----> <!----> <span class="tm-icon-counter tm-data-icons__item"><svg height="24" width="24" class="tm-svg-img tm-icon-counter__icon"><title>Количество просмотров</title> <use xlink:href="/img/megazord-v28.c350aa68..svg#counter-views"></use></svg> <span class="tm-icon-counter__value">3.1K</span></span> <!----> <!----> <div class="tm-article-comments-counter-link tm-data-icons__item" title="Читать комментарии"><a href="https://habr.com/ru/company/otus/blog/725902/comments/" class="tm-article-comments-counter-link__link"><svg height="24" width="24" class="tm-svg-img tm-article-comments-counter-link__icon"><title>Комментарии</title> <use xlink:href="/img/megazord-v28.c350aa68..svg#counter-comments"></use></svg> <span class="tm-article-comments-counter-link__value">
      4
    </span></a> <a href="https://habr.com/ru/company/otus/blog/725902/comments/" class="tm-article-comments-counter-link__link"><div title="Читать новые комментарии" class="tm-article-comments-counter-link__unread-counter"><span>+4</span></div></a></div>  <div class="v-portal" style="display: none;"></div></div></article></li><li class="tm-article-list-block__item"><article class="tm-article-snippet-block-sidebar tm-article-snippet-block-sidebar_preview"><div class="tm-article-snippet-block__user-meta"><div class="tm-article-snippet-block__date"><time datetime="2023-03-29T14:03:33.000Z" title="2023-03-29, 17:03">29  мар   в 17:03</time></div></div> <h2 class="tm-article-title tm-article-title_sidebar"><a href="https://habr.com/ru/company/otus/blog/725424/" class="tm-article-title__link"><span>Файловая система BTRFS</span></a></h2> <div class="tm-data-icons"><!----> <!----> <span class="tm-icon-counter tm-data-icons__item"><svg height="24" width="24" class="tm-svg-img tm-icon-counter__icon"><title>Количество просмотров</title> <use xlink:href="/img/megazord-v28.c350aa68..svg#counter-views"></use></svg> <span class="tm-icon-counter__value">9.4K</span></span> <!----> <!----> <div class="tm-article-comments-counter-link tm-data-icons__item" title="Читать комментарии"><a href="https://habr.com/ru/company/otus/blog/725424/comments/" class="tm-article-comments-counter-link__link"><svg height="24" width="24" class="tm-svg-img tm-article-comments-counter-link__icon"><title>Комментарии</title> <use xlink:href="/img/megazord-v28.c350aa68..svg#counter-comments"></use></svg> <span class="tm-article-comments-counter-link__value">
      33
    </span></a> <a href="https://habr.com/ru/company/otus/blog/725424/comments/" class="tm-article-comments-counter-link__link"><div title="Читать новые комментарии" class="tm-article-comments-counter-link__unread-counter"><span>+33</span></div></a></div>  <div class="v-portal" style="display: none;"></div></div></article></li><li class="tm-article-list-block__item"><article class="tm-article-snippet-block-sidebar tm-article-snippet-block-sidebar_preview"><div class="tm-article-snippet-block__user-meta"><div class="tm-article-snippet-block__date"><time datetime="2023-03-29T13:03:01.000Z" title="2023-03-29, 16:03">29  мар   в 16:03</time></div></div> <h2 class="tm-article-title tm-article-title_sidebar"><a href="https://habr.com/ru/company/otus/blog/725606/" class="tm-article-title__link"><span>Миграция PostgreSQL с DBaaS на дроплет Digital Ocean</span></a></h2> <div class="tm-data-icons"><!----> <!----> <span class="tm-icon-counter tm-data-icons__item"><svg height="24" width="24" class="tm-svg-img tm-icon-counter__icon"><title>Количество просмотров</title> <use xlink:href="/img/megazord-v28.c350aa68..svg#counter-views"></use></svg> <span class="tm-icon-counter__value">616</span></span> <!----> <!----> <div class="tm-article-comments-counter-link tm-data-icons__item" title="Читать комментарии"><a href="https://habr.com/ru/company/otus/blog/725606/comments/" class="tm-article-comments-counter-link__link"><svg height="24" width="24" class="tm-svg-img tm-article-comments-counter-link__icon"><title>Комментарии</title> <use xlink:href="/img/megazord-v28.c350aa68..svg#counter-comments"></use></svg> <span class="tm-article-comments-counter-link__value">
      1
    </span></a> <a href="https://habr.com/ru/company/otus/blog/725606/comments/" class="tm-article-comments-counter-link__link"><div title="Читать новые комментарии" class="tm-article-comments-counter-link__unread-counter"><span>+1</span></div></a></div>  <div class="v-portal" style="display: none;"></div></div></article></li> <!----></ul></div> <!----></section> <!----> <!----></div></div></div></div></div></div></main> <!----></div> <div class="tm-footer-menu"><div class="tm-page-width"><div class="tm-footer-menu__container"><div class="tm-footer-menu__block"><p class="tm-footer-menu__block-title">
          Ваш аккаунт
        </p> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="https://habr.com/kek/v1/auth/habrahabr/?back=/ru/company/otus/blog/546158/&amp;hl=ru" rel="nofollow" target="_self">
                Войти
              </a></li><li class="tm-footer-menu__list-item"><a href="https://habr.com/kek/v1/auth/habrahabr-register/?back=/ru/company/otus/blog/546158/&amp;hl=ru" rel="nofollow" target="_self">
                Регистрация
              </a></li></ul></div></div><div class="tm-footer-menu__block"><p class="tm-footer-menu__block-title">
          Разделы
        </p> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="https://habr.com/ru/" class="footer-menu__item-link router-link-active">
                Публикации
              </a></li><li class="tm-footer-menu__list-item"><a href="https://habr.com/ru/news/" class="footer-menu__item-link">
                Новости
              </a></li><li class="tm-footer-menu__list-item"><a href="https://habr.com/ru/hubs/" class="footer-menu__item-link">
                Хабы
              </a></li><li class="tm-footer-menu__list-item"><a href="https://habr.com/ru/companies/" class="footer-menu__item-link">
                Компании
              </a></li><li class="tm-footer-menu__list-item"><a href="https://habr.com/ru/users/" class="footer-menu__item-link">
                Авторы
              </a></li><li class="tm-footer-menu__list-item"><a href="https://habr.com/ru/sandbox/" class="footer-menu__item-link">
                Песочница
              </a></li></ul></div></div><div class="tm-footer-menu__block"><p class="tm-footer-menu__block-title">
          Информация
        </p> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="https://habr.com/ru/docs/help/" class="footer-menu__item-link">
                Устройство сайта
              </a></li><li class="tm-footer-menu__list-item"><a href="https://habr.com/ru/docs/authors/codex/" class="footer-menu__item-link">
                Для авторов
              </a></li><li class="tm-footer-menu__list-item"><a href="https://habr.com/ru/docs/companies/corpblogs/" class="footer-menu__item-link">
                Для компаний
              </a></li><li class="tm-footer-menu__list-item"><a href="https://habr.com/ru/docs/docs/transparency/" class="footer-menu__item-link">
                Документы
              </a></li><li class="tm-footer-menu__list-item"><a href="https://account.habr.com/info/agreement" target="_blank">
                Соглашение
              </a></li><li class="tm-footer-menu__list-item"><a href="https://account.habr.com/info/confidential/" target="_blank">
                Конфиденциальность
              </a></li></ul></div></div><div class="tm-footer-menu__block"><p class="tm-footer-menu__block-title">
          Услуги
        </p> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="https://company.habr.com/ru/corporate-blogs/" target="_blank">
                Корпоративный блог
              </a></li><li class="tm-footer-menu__list-item"><a href="https://company.habr.com/ru/advertising/" target="_blank">
                Медийная реклама
              </a></li><li class="tm-footer-menu__list-item"><a href="https://company.habr.com/ru/native-special/" target="_blank">
                Нативные проекты
              </a></li><li class="tm-footer-menu__list-item"><a href="https://company.habr.com/ru/education-programs/" target="_blank">
                Образовательные программы
              </a></li><li class="tm-footer-menu__list-item"><a href="https://company.habr.com/ru/hello-startup/" target="_blank">
                Стартапам
              </a></li><li class="tm-footer-menu__list-item"><a href="https://habr.com/ru/megaprojects/" class="footer-menu__item-link">
                Мегапроекты
              </a></li></ul></div></div></div></div></div> <div class="tm-footer"><div class="tm-page-width"><div class="tm-footer__container"><!----> <div class="tm-footer__social"><a href="https://www.facebook.com/habrahabr.ru" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Facebook</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-facebook"></use></svg></a><a href="https://twitter.com/habr_com" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Twitter</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-twitter"></use></svg></a><a href="https://vk.com/habr" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>VK</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-vkontakte"></use></svg></a><a href="https://telegram.me/habr_com" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Telegram</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-telegram"></use></svg></a><a href="https://www.youtube.com/channel/UCd_sTwKqVrweTt4oAKY5y4w" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Youtube</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-youtube"></use></svg></a><a href="https://zen.yandex.ru/habr" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Яндекс Дзен</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-zen"></use></svg></a></div> <div class="v-portal" style="display:none;"></div> <button class="tm-footer__link"><!---->
        Настройка языка
      </button> <a href="https://habr.com/ru/feedback/" class="tm-footer__link">
        Техническая поддержка
      </a> <a href="https://habr.com/berserk-mode-nope" class="tm-footer__link">
        Вернуться на старую версию
      </a> <div class="tm-footer-copyright"><span class="tm-copyright"><span class="tm-copyright__years">© 2006–2023, </span> <span class="tm-copyright__name"><a href="https://company.habr.com/" rel="noopener" target="_blank" class="tm-copyright__link">Habr</a></span></span></div></div></div></div> <!----> <!----></div> <div class="vue-portal-target"><!----></div></div>

<script src="./Динамический полиморфизм с использованием std__variant и std__visit _ Хабр_files/chunk-vendors.aa19bb97.js.загрузка" defer=""></script><script src="./Динамический полиморфизм с использованием std__variant и std__visit _ Хабр_files/7298.c8f1d73c.js.загрузка" defer=""></script><script src="./Динамический полиморфизм с использованием std__variant и std__visit _ Хабр_files/app.5b494952.js.загрузка" defer=""></script>



    <script async="" src="./Динамический полиморфизм с использованием std__variant и std__visit _ Хабр_files/js"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
    </script>
  
  <script type="text/javascript">
    (function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
    m[i].l=1*new Date();k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})
    (window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");

    ym(24049213, "init", {
      defer:true,
      trackLinks:true,
      accurateTrackBounce:true,
      webvisor:false,
    });
  </script>
  <noscript>
    <div>
      <img src="https://mc.yandex.ru/watch/24049213" style="position:absolute; left:-9999px;" alt="" />
    </div>
  </noscript>
  
    <script type="text/javascript">
      window.addEventListener('load', function () {
        setTimeout(() => {
          const img = new Image();
          img.src = 'https://vk.com/rtrg?p=VK-RTRG-421343-57vKE';
        }, 0);
      });
    </script>
  
<script src="./Динамический полиморфизм с использованием std__variant и std__visit _ Хабр_files/ads.js.загрузка" onload="window[&#39;zhY4i4nJ9K&#39;] = true"></script><div id="K9Jn4i4Yhz" style="display: none;"></div>


<div><div><div class="Vue-Toastification__container top-left"></div></div><div><div class="Vue-Toastification__container top-center"></div></div><div><div class="Vue-Toastification__container top-right"></div></div><div><div class="Vue-Toastification__container bottom-left"></div></div><div><div class="Vue-Toastification__container bottom-center"></div></div><div><div class="Vue-Toastification__container bottom-right"></div></div></div></body></html>